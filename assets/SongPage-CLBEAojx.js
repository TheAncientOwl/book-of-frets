import{j as e,F as a,B as c,S,I as k,k as w,T as l,H as g,l as b,e as I,h as j,g as A,A as T,L as z,m as u,P as L,n as W,o as f,p as $,q as R,r as O,s as F,t as B,v as D,w as E,x as M,y as H,C as G}from"./chakra-c0uodu4U.js";import{r as m,u as _}from"./react-BTPqQck7.js";import{u as d,a as U}from"./index-BeihjV1V.js";import{G as N,a as q,I as V,b as C}from"./react-icons-CXydn5A8.js";import{C as X}from"./Chord-BjJuUnXS.js";const Y={acoustic:e.jsx(q,{}),electric:e.jsx(N,{})},J=t=>{const{song:s}=d(),[r,n]=m.useState(!1);return e.jsxs(a,{direction:"column",alignItems:"center",mb:"15px",children:[e.jsxs(c,{position:"relative",width:["70px","80px"],height:["70px","80px"],mb:["5px"],children:[e.jsx(S,{isLoaded:r,width:"100%",height:"100%",borderRadius:"10px",children:e.jsx(k,{src:`/songs/${t.directory}/cover.jpeg`,alt:`${t.title} cover`,width:"100%",height:"100%",objectFit:"cover",borderRadius:"10px",borderStyle:"solid",borderWidth:"thin",onLoad:()=>n(!0),borderColor:s.header.coverBorder})}),e.jsx(w,{position:"absolute",right:"0",top:"0",transform:"translate(50%, -50%)",size:"1em",padding:"15px",fontWeight:"bold",borderWidth:"thin",backgroundColor:s.capo.background,borderColor:s.capo.border,color:s.capo.text,children:e.jsxs(a,{alignItems:"end",children:[e.jsx(l,{fontSize:"sm",children:"C"}),e.jsx(l,{fontSize:"xs",children:t.capo})]})})]}),e.jsx(g,{noOfLines:1,as:"h1",size:["sm","md"],mb:["5px"],textAlign:"center",color:s.header.title,children:t.title}),e.jsx(g,{noOfLines:1,as:"h2",size:["xs","sm"],mb:["5px"],fontStyle:"italic",textAlign:"center",color:s.header.artists,children:t.artists.map((i,o)=>e.jsxs(c,{as:"span",children:[i," ",o<t.artists.length-1&&", "]},o))}),e.jsx(a,{justifyContent:"center",color:s.header.typeTags,children:t.type.map((i,o)=>e.jsx(m.Fragment,{children:e.jsx(b,{label:i,children:Y[i]})},o))})]})},K=t=>{try{const s=new URL(t);return s.hostname==="www.youtube.com"||s.hostname==="youtube.com"||s.hostname==="m.youtube.com"?s.pathname.startsWith("/shorts/")?s.pathname.split("/")[2]:s.searchParams.get("v"):s.hostname==="youtu.be"?s.pathname.slice(1):null}catch{return null}},Q=t=>{const{song:s}=d(),r=K(t.link),[n,i]=m.useState(!1);return e.jsx(I,{children:e.jsxs(a,{direction:"column",alignItems:"center",textAlign:"center",children:[e.jsx(j,{as:V,color:s.resources.item.note}),e.jsx(A,{isExternal:!0,href:t.link.replaceAll("{book-of-frets}","/"),size:["xs","sm"],color:s.resources.item.alias,children:t.alias}),t.author!=="-"&&e.jsxs(l,{fontStyle:"italic",textAlign:"center",fontSize:["small","sm"],color:s.resources.item.author,children:["by ",t.author]}),r&&e.jsx(c,{width:"100%",maxW:"400px",my:2,overflow:"hidden",borderRadius:"10px",children:e.jsx(T,{ratio:16/9,children:e.jsx(S,{isLoaded:n,height:"100%",width:"100%",children:e.jsx("iframe",{src:`https://www.youtube.com/embed/${r}`,title:t.alias,allow:"accelerometer;  clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,onLoad:()=>i(!0),style:{width:"100%",height:"100%",border:"none"}})})})})]})})},Z=t=>{const{song:s}=d();return e.jsxs(c,{mt:"1em",padding:"1em 1.25em",children:[e.jsx(g,{as:"h1",size:"md",mb:"1em",textAlign:"center",children:e.jsxs(a,{justifyContent:"center",alignItems:"center",gap:"0.25em",color:s.resources.title,children:[e.jsx(j,{as:C}),"Resources",e.jsx(j,{as:C})]})}),t.resources.length===0&&e.jsx(l,{textAlign:"center",children:"Nothing here yet"}),e.jsx(z,{children:t.resources.map((r,n)=>e.jsxs(m.Fragment,{children:[e.jsx(Q,{...r}),n<t.resources.length-1&&e.jsx(u,{mt:"1em",mb:"1em"})]},n))})]})},ee="-",te=t=>{const{song:s}=d(),{chordsIndex:r}=U();return e.jsxs(a,{direction:"column",alignItems:"center",children:[e.jsx(a,{direction:"row",gap:"1em",mb:"0.6em",children:t.chordIDs.map((n,i)=>{const o=r[n];return console.assert(o!==void 0,`Missing chord index for ID '${n}'`),e.jsx(c,{as:"span",children:e.jsxs(L,{children:[e.jsx(W,{children:e.jsx(f,{fontWeight:"bold",cursor:"pointer",backgroundColor:s.segments.item.chordsPattern.chord.background,color:s.segments.item.chordsPattern.chord.color,children:n!==ee?o.name:"-"})}),e.jsx($,{children:e.jsxs(R,{zIndex:1,backgroundColor:s.segments.item.chordsPattern.chord.segment.popover.background,borderColor:s.segments.item.chordsPattern.chord.segment.popover.border,children:[e.jsx(O,{backgroundColor:s.segments.item.chordsPattern.chord.segment.popover.arrow}),e.jsx(F,{color:s.segments.item.chordsPattern.chord.segment.popover.closeButton}),e.jsx(a,{justifyContent:"center",padding:"25px",children:e.jsx(X,{name:o.name,frets:o.frets})})]})})]})},i)})}),t.showChordTimes&&e.jsx(b,{label:`Strum ${t.chordTimes} times`,children:e.jsxs(l,{fontSize:"xs",fontWeight:"bold",color:s.segments.item.chordsPattern.chord.segment.times,children:["x",t.chordTimes]})}),e.jsx(c,{position:"relative",mt:"0.4em",children:e.jsx(a,{direction:"row",gap:"0.5em",alignItems:"end",color:s.segments.item.chordsPattern.chord.segment.pattern,children:t.strummingPattern.map((n,i)=>e.jsx(l,{fontWeight:"bold",children:n},i))})})]})},y=t=>{const{song:s}=d();return e.jsx(u,{orientation:"vertical",height:["0px","80px"],borderWidth:"thin",mt:["15px","0px"],mb:["15px","0px"],borderColor:s.segments.item.chordsPattern.divider,...t})},se=t=>{const{song:s}=d();return e.jsxs(c,{width:"100%",position:"relative",display:["box","flex"],gap:"1em",alignItems:"center",justifyContent:"center",children:[e.jsx(y,{borderStyle:["solid"]}),t.segments.map((r,n)=>e.jsxs(m.Fragment,{children:[e.jsx(te,{...r,showChordTimes:t.showChordTimes}),e.jsx(y,{borderStyle:["dashed","solid"],display:[n<t.segments.length-1?"block":"none","block"]})]},n)),e.jsx(b,{label:`Repeat ${t.times} times`,borderColor:s.segments.item.chordsPattern.divider,children:e.jsxs(f,{size:"sm",fontWeight:"bold",position:"absolute",top:"50%",right:"0",transform:"translate(0%, -50%)",zIndex:1,backgroundColor:s.segments.item.chordsPattern.chord.times.background,color:s.segments.item.chordsPattern.chord.times.color,children:["x",t.times]})})]})},h=t=>{const{song:s}=d();return e.jsxs(a,{direction:"row",alignItems:"center",gap:"1em",position:"relative",children:[e.jsx(g,{size:"md",color:s.segments.item.stringsPattern.stringNames,children:t.name}),e.jsx(a,{direction:"row",position:"absolute",left:"30px",alignItems:"center",gap:"5px",children:t.frets.map((r,n)=>r==="-"?e.jsx(c,{width:"1.4em",children:e.jsx(u,{borderWidth:"thin",borderColor:s.segments.item.stringsPattern.filler})}):r==="|"?e.jsx(c,{color:s.segments.item.stringsPattern.filler,children:"|"}):e.jsx(c,{width:"1.4em",children:e.jsx(w,{size:"1.4em",fontWeight:"bold",borderWidth:"thin",backgroundColor:s.segments.item.stringsPattern.fret.background,borderColor:s.segments.item.stringsPattern.fret.border,color:s.segments.item.stringsPattern.fret.text,children:r},n)}))})]})},re=t=>{const{song:s}=d(),r=[["-"],["-"],["-"],["-"],["-"],["-"],["-"]];return t.segments.forEach(n=>{n.forEach(o=>{const{string:p,fret:x}=o;r[p].push(x)});const i=Math.max(...r.map(o=>o.length));r.forEach(o=>{o.length!=i&&o.push("-")})}),e.jsxs(a,{direction:"column",gap:"0.5em",width:"100%",overflow:"scroll",children:[e.jsx(h,{name:"E",frets:r[6]}),e.jsx(h,{name:"B",frets:r[5]}),e.jsx(h,{name:"G",frets:r[4]}),e.jsx(h,{name:"D",frets:r[3]}),e.jsx(h,{name:"A",frets:r[2]}),e.jsx(h,{name:"E",frets:r[1]}),e.jsx(u,{borderColor:s.segments.item.stringsPattern.divider})]})},ne=t=>{const{song:s}=d();return e.jsx(g,{as:"h3",size:"md",textAlign:"center",textDecoration:"underline",textTransform:"capitalize",color:s.segments.item.title,children:e.jsxs(l,{as:"span",position:"relative",fontSize:["lg","xl"],children:[t.name,t.times>1&&e.jsxs(f,{size:"sm",position:"absolute",bottom:0,right:0,transform:"translate(120%, 20%)",backgroundColor:s.segments.item.times.background,color:s.segments.item.times.color,children:["x",t.times]})]})})},oe=t=>e.jsx(a,{direction:"column",alignItems:"center",gap:"1em",children:t.patterns.map((s,r)=>t.type==="chords"?e.jsx(se,{...s,showChordTimes:t.showChordTimes},r):t.type==="strings"?e.jsx(re,{...s,showChordTimes:t.showChordTimes},r):(console.warn(`Unimplemented pattern type "${t.type}`),e.jsx(e.Fragment,{})))}),ie=t=>{const{song:s}=d();return e.jsx(B,{allowMultiple:!0,padding:"1.5em 1em",borderRadius:"1rem",defaultIndex:t.songSegmentsOrder.map((r,n)=>n),backgroundColor:s.segments.background,children:t.songSegmentsOrder.map((r,n)=>{const i=t.songSegments[r];console.assert(i!==void 0,`Failed to find song segment data for "${r}"`);const o=Object.entries(t.songSegments).some(([p,x])=>x.type==="chords"&&x.patterns.some(v=>v.segments.some(P=>P.chordTimes>1)));return e.jsxs(D,{borderColor:s.segments.divider,children:[e.jsxs(E,{display:"flex",justifyContent:"flex-end",alignItems:"center",position:"relative",pt:["10px","15px"],pb:["10px","15px"],backgroundColor:"blackAlpha.100",_hover:{backgroundColor:"blackAlpha.100"},children:[e.jsx(c,{position:"absolute",left:"50%",transform:"translateX(-50%)",textAlign:"center",width:"100%",children:e.jsx(ne,{...i,showChordTimes:o})}),e.jsx(M,{color:s.segments.item.title})]}),e.jsx(H,{children:e.jsx(oe,{...i,showChordTimes:o})})]},`${r}-${n}`)})})},ae=t=>{const{song:s}=d();return e.jsxs(G,{maxW:["100vw","5xl"],padding:["25px 10px","2em 1em"],borderRadius:"1rem",backgroundColor:s.background,children:[e.jsx(J,{directory:t.directory,title:t.title,artists:t.artists,capo:t.capo,type:t.type}),e.jsx(ie,{songSegments:t.songSegments,songSegmentsOrder:t.songSegmentsOrder}),e.jsx(Z,{resources:t.resources})]})},ge=()=>{const{directory:t}=_(),[s,r]=m.useState(null);return m.useEffect(()=>{t&&fetch(`/songs/${t}/config.json`).then(n=>n.ok?n.json():(console.error(`Song ${t} not found`),null)).then(n=>{n&&r(n)})},[t]),s?e.jsx(ae,{directory:t||"",title:s.title,artists:s.artists,capo:s.capo,songSegments:s.songSegments,songSegmentsOrder:s.songSegmentsOrder,resources:s.resources,type:s.type}):e.jsx("div",{children:"Loading song..."})};export{ge as SongPage,ge as default};
