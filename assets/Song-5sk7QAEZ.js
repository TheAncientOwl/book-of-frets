import{j as e,F as o,B as a,k as j,T as h,l as c,H as g,m as f,n as b,d as p,o as C}from"./chakra-BXjVzkSj.js";import{r as l,u as w}from"./react-BTPqQck7.js";import{u as S}from"./index-NVvvGs_R.js";import{G as y,b as T}from"./react-icons-BYfOYJzJ.js";const v="-",I=t=>{const{chordsIndex:n}=S();return e.jsxs(o,{direction:"column",alignItems:"center",children:[e.jsx(o,{direction:"row",gap:"1em",mb:"0.6em",children:t.chordIDs.map((r,s)=>{const i=n[r];return console.assert(i!==void 0,`Missing chord index for ID '${r}'`),e.jsx(a,{as:"span",children:e.jsx(j,{backgroundColor:"green.200",fontWeight:"bold",children:r!==v?i.name:"-"})},s)})}),t.showChordTimes&&e.jsxs(h,{fontSize:"xs",fontWeight:"bold",children:["x",t.chordTimes]}),e.jsx(a,{position:"relative",mt:"0.4em",children:e.jsx(o,{direction:"row",gap:"0.5em",alignItems:"end",children:t.strummingPattern.map((r,s)=>e.jsx(h,{fontWeight:"bold",children:r},s))})})]})},z=t=>e.jsxs(o,{direction:"row",gap:"1em",alignItems:"center",justifyContent:"center",position:"relative",width:"100%",children:[e.jsx(c,{orientation:"vertical",height:"80px",borderColor:"gray.200",borderWidth:"thin"}),t.segments.map((n,r)=>e.jsxs(l.Fragment,{children:[e.jsx(I,{...n,showChordTimes:t.showChordTimes}),e.jsx(c,{orientation:"vertical",height:"80px",borderColor:"gray.200",borderWidth:"thin"})]},r)),e.jsxs(j,{size:"sm",fontWeight:"bold",backgroundColor:"green.200",position:"absolute",top:"50%",right:"0",transform:"translate(0%, -50%)",zIndex:1,children:["x",t.times]})]}),d=t=>e.jsxs(o,{direction:"row",alignItems:"center",gap:"1em",position:"relative",children:[e.jsx(g,{size:"md",children:t.name}),e.jsx(o,{direction:"row",position:"absolute",left:"30px",alignItems:"center",gap:"5px",children:t.frets.map((n,r)=>e.jsx(a,{children:n==="-"?e.jsx(a,{width:"1.4em",children:e.jsx(c,{borderColor:"black",borderWidth:"thin"})}):e.jsx(a,{width:"1.4em",children:e.jsx(f,{size:"1.4em",bg:"green.300",color:"green.900",fontWeight:"bold",borderColor:"green.900",borderWidth:"thin",children:n},r)})}))})]}),W=t=>{const n=[["-"],["-"],["-"],["-"],["-"],["-"],["-"]];return t.segments.forEach(r=>{r.forEach(i=>{const{string:m,fret:x}=i;n[m].push(x)});const s=Math.max(...n.map(i=>i.length));n.forEach(i=>{i.length!=s&&i.push("-")})}),e.jsxs(o,{direction:"column",gap:"0.5em",width:"100%",overflow:"scroll",children:[e.jsx(d,{name:"E",frets:n[6]}),e.jsx(d,{name:"B",frets:n[5]}),e.jsx(d,{name:"G",frets:n[4]}),e.jsx(d,{name:"D",frets:n[3]}),e.jsx(d,{name:"A",frets:n[2]}),e.jsx(d,{name:"E",frets:n[1]}),e.jsx(c,{borderColor:"green.900"})]})},$=t=>e.jsxs(a,{alignItems:"center",mb:"1em",children:[e.jsx(g,{as:"h3",size:"md",mb:"1em",textAlign:"center",textDecoration:"underline",textTransform:"capitalize",children:t.name}),e.jsx(o,{direction:"column",alignItems:"center",gap:"1em",children:t.patterns.map((n,r)=>t.type==="chords"?e.jsx(z,{...n,showChordTimes:t.showChordTimes},r):t.type==="strings"?e.jsx(W,{...n,showChordTimes:t.showChordTimes},r):(console.warn(`Unimplemented pattern type "${t.type}`),e.jsx(e.Fragment,{})))})]}),k={acoustic:e.jsx(T,{}),electric:e.jsx(y,{})},F=t=>e.jsxs(b,{maxW:["100vw","5xl"],backgroundColor:"#237738ff",padding:["25px 10px","2em 1em"],borderRadius:"1rem",children:[e.jsxs(o,{direction:"column",alignItems:"center",mb:"15px",children:[e.jsxs(a,{position:"relative",width:["70px","80px"],height:["70px","80px"],mb:["5px"],children:[e.jsx(p,{src:`/book-of-frets/songs/${t.directory}/cover.png`,alt:`${t.title} cover`,width:"100%",height:"100%",objectFit:"cover",borderRadius:"10px",borderStyle:"solid"}),e.jsx(f,{position:"absolute",right:"0",top:"0",transform:"translate(50%, -50%)",size:"1em",padding:"15px",bg:"green.300",color:"green.900",fontWeight:"bold",borderColor:"green.400",borderWidth:"thin",children:e.jsxs(o,{alignItems:"end",children:[e.jsx(h,{fontSize:"sm",children:"C"}),e.jsx(h,{fontSize:"xs",children:t.capo})]})})]}),e.jsx(g,{noOfLines:1,as:"h1",size:["sm","md"],mb:["5px"],color:"CaptionText",textAlign:"center",children:t.title}),e.jsx(g,{noOfLines:1,as:"h2",size:["xs","sm"],mb:["5px"],fontStyle:"italic",textAlign:"center",children:t.artists.map((n,r)=>e.jsxs(a,{as:"span",children:[n," ",r<t.artists.length-1&&", "]},r))}),e.jsx(o,{justifyContent:"center",children:t.type.map((n,r)=>e.jsx(l.Fragment,{children:e.jsx(C,{label:n,children:k[n]})},r))})]}),e.jsx(o,{direction:"column",gap:"5px",bgColor:"blackAlpha.400",padding:"1.5em 1em",borderRadius:"1rem",children:t.songSegmentsOrder.map((n,r)=>{const s=t.songSegments[n];return console.assert(s!==void 0,`Failed to find song segment data for "${n}"`),e.jsxs(l.Fragment,{children:[e.jsx($,{...s,showChordTimes:Object.entries(t.songSegments).some(([i,m])=>m.type==="chords"&&m.patterns.some(x=>x.segments.some(u=>u.chordTimes>1)))}),e.jsx(c,{borderColor:"gray.900",mb:"1em"})]},`${n}-${r}`)})})]}),G=()=>{const{directory:t}=w(),[n,r]=l.useState(null);return l.useEffect(()=>{t&&fetch(`/book-of-frets/songs/${t}/config.json`).then(s=>s.ok?s.json():(console.error(`Song ${t} not found`),null)).then(s=>{s&&r(s)})},[t]),n?e.jsx(F,{directory:t||"",title:n.title,artists:n.artists,capo:n.capo,songSegments:n.songSegments,songSegmentsOrder:n.songSegmentsOrder,resources:n.resources,type:n.type}):e.jsx("div",{children:"Loading song..."})};export{G as Song,G as default};
