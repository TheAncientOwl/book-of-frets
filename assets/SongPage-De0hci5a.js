import{j as e,F as c,B as d,S,I as L,k as y,T as l,H as u,P as w,l as v,m as P,n as I,o as A,p as R,q as W,r as j,e as E,h as b,g as $,A as D,L as M,s as x,v as f,w as B,x as H,y as O,z as F,E as _,G,C as U}from"./chakra-fmRuBFkh.js";import{r as h,u as N}from"./react-Djq6mIGJ.js";import{u as a,a as Y,s as Z}from"./index-KvmNOjLZ.js";import{G as q,a as V,I as X,b as k}from"./react-icons-Bz7ZZPxh.js";import{C as J}from"./Chord-Bw31Fniz.js";import"./react-virtualized-BDZWj5_A.js";const K={acoustic:e.jsx(V,{}),electric:e.jsx(q,{})},Q=t=>{const{song:r}=a(),[o,s]=h.useState(!1);return e.jsxs(c,{direction:"column",alignItems:"center",mb:"15px",children:[e.jsxs(d,{position:"relative",width:["70px","80px"],height:["70px","80px"],mb:["5px"],children:[e.jsx(S,{isLoaded:o,width:"100%",height:"100%",borderRadius:"10px",children:e.jsx(L,{src:`/songs/${t.directory}/cover.webp`,alt:`${t.title} cover`,width:"100%",height:"100%",objectFit:"cover",borderRadius:"10px",borderStyle:"solid",borderWidth:"thin",onLoad:()=>s(!0),borderColor:r.header.coverBorder})}),e.jsx(y,{position:"absolute",right:"0",top:"0",transform:"translate(50%, -50%)",size:"1em",padding:"15px",fontWeight:"bold",borderWidth:"thin",backgroundColor:r.capo.background,borderColor:r.capo.border,color:r.capo.text,children:e.jsxs(c,{alignItems:"end",children:[e.jsx(l,{fontSize:"sm",children:"C"}),e.jsx(l,{fontSize:"xs",children:t.capo})]})})]}),e.jsx(u,{noOfLines:1,as:"h1",size:["sm","md"],mb:["5px"],textAlign:"center",color:r.header.title,children:t.title}),e.jsx(u,{noOfLines:1,as:"h2",size:["xs","sm"],mb:["5px"],fontStyle:"italic",textAlign:"center",color:r.header.artists,children:t.artists.map((n,i)=>e.jsxs(d,{as:"span",children:[n," ",i<t.artists.length-1&&", "]},i))}),e.jsxs(w,{children:[e.jsx(v,{children:e.jsx(l,{as:"button",fontSize:"sm",mb:"10px",color:r.header.artists,_hover:{textDecoration:"underline",cursor:"pointer"},children:"Contributors"})}),e.jsxs(P,{textAlign:"center",borderColor:r.header.contributors.border,children:[e.jsx(I,{backgroundColor:r.header.contributors.heading}),e.jsx(A,{color:r.header.contributors.title}),e.jsx(R,{fontWeight:"bold",borderBottom:"1px solid",backgroundColor:r.header.contributors.heading,color:r.header.contributors.title,children:"Song contributed by"}),e.jsx(W,{backgroundColor:r.header.contributors.content,color:r.header.contributors.contributor,children:t.contributors.length>0?t.contributors.map((n,i)=>e.jsx(l,{fontSize:"sm",mb:i<t.contributors.length-1?"2px":"0",children:n},i)):e.jsx(l,{fontSize:"sm",fontStyle:"italic",children:"No contributors"})})]})]}),e.jsx(c,{justifyContent:"center",color:r.header.typeTags,children:t.type.map((n,i)=>e.jsx(h.Fragment,{children:e.jsx(j,{label:n,children:K[n]})},i))})]})},ee=t=>{try{const r=new URL(t);return r.hostname==="www.youtube.com"||r.hostname==="youtube.com"||r.hostname==="m.youtube.com"?r.pathname.startsWith("/shorts/")?r.pathname.split("/")[2]:r.searchParams.get("v"):r.hostname==="youtu.be"?r.pathname.slice(1):null}catch{return null}},te=t=>{const{song:r}=a(),o=ee(t.link),[s,n]=h.useState(!1);return e.jsx(E,{children:e.jsxs(c,{direction:"column",alignItems:"center",textAlign:"center",children:[e.jsx(b,{as:X,color:r.resources.item.note}),e.jsx($,{isExternal:!0,href:t.link.replaceAll("{book-of-frets}","/"),size:["xs","sm"],color:r.resources.item.alias,children:t.alias}),t.author!=="-"&&e.jsxs(l,{fontStyle:"italic",textAlign:"center",fontSize:["small","sm"],color:r.resources.item.author,children:["by ",t.author]}),o&&e.jsx(d,{width:"100%",maxW:"400px",my:2,overflow:"hidden",borderRadius:"10px",children:e.jsx(D,{ratio:16/9,children:e.jsx(S,{isLoaded:s,height:"100%",width:"100%",children:e.jsx("iframe",{src:`https://www.youtube.com/embed/${o}`,title:t.alias,allow:"accelerometer;  clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,onLoad:()=>n(!0),style:{width:"100%",height:"100%",border:"none"}})})})})]})})},re=t=>{const{song:r}=a();return e.jsxs(d,{mt:"1em",padding:"1em 1.25em",children:[e.jsx(u,{as:"h1",size:"md",mb:"1em",textAlign:"center",children:e.jsxs(c,{justifyContent:"center",alignItems:"center",gap:"0.25em",color:r.resources.title,children:[e.jsx(b,{as:k}),"Resources",e.jsx(b,{as:k})]})}),t.resources.length===0&&e.jsx(l,{textAlign:"center",children:"Nothing here yet"}),e.jsx(M,{children:t.resources.map((o,s)=>e.jsxs(h.Fragment,{children:[e.jsx(te,{...o}),s<t.resources.length-1&&e.jsx(x,{mt:"1em",mb:"1em"})]},s))})]})},oe=["De","Ue"],se="e",ne="-",ie=t=>{const{song:r}=a(),{chordsIndex:o}=Y();return e.jsxs(c,{direction:"column",alignItems:"center",children:[e.jsx(c,{direction:"row",gap:"1em",mb:"0.6em",children:t.chordIDs.map((s,n)=>{const i=o[s];return console.assert(i!==void 0,`Missing chord index for ID '${s}'`),e.jsx(d,{as:"span",children:e.jsxs(w,{children:[e.jsx(v,{children:e.jsx(f,{fontWeight:"bold",cursor:"pointer",backgroundColor:r.chunks.item.chordsPattern.chord.background,color:r.chunks.item.chordsPattern.chord.color,children:s!==ne?i.name:"-"})}),e.jsx(B,{children:e.jsxs(P,{zIndex:1,backgroundColor:r.chunks.item.chordsPattern.chord.segment.popover.background,borderColor:r.chunks.item.chordsPattern.chord.segment.popover.border,children:[e.jsx(I,{backgroundColor:r.chunks.item.chordsPattern.chord.segment.popover.arrow}),e.jsx(A,{color:r.chunks.item.chordsPattern.chord.segment.popover.closeButton}),e.jsx(c,{justifyContent:"center",padding:"25px",children:e.jsx(J,{name:i.name,frets:i.frets})})]})})]})},n)})}),t.showChordTimes&&e.jsx(j,{label:`Strum ${t.chordTimes} times`,children:e.jsxs(l,{fontSize:"xs",fontWeight:"bold",color:r.chunks.item.chordsPattern.chord.segment.times,children:["x",t.chordTimes]})}),e.jsx(d,{position:"relative",mt:"0.4em",children:e.jsx(c,{direction:"row",gap:"0.5em",alignItems:"end",color:r.chunks.item.chordsPattern.chord.segment.pattern,children:t.strummingPattern.map((s,n)=>e.jsx(l,{fontWeight:"bold",textDecoration:oe.includes(s)?"underline":"none",children:s.replace(se,"")},n))})})]})},C=t=>{const{song:r}=a();return e.jsx(x,{orientation:"vertical",height:["0px","80px"],borderWidth:"thin",mt:["15px","0px"],mb:["15px","0px"],borderColor:r.chunks.item.chordsPattern.divider,...t})},ce=t=>{const{song:r}=a();return e.jsxs(d,{width:"100%",position:"relative",display:["box","flex"],gap:"1em",alignItems:"center",justifyContent:"center",children:[e.jsx(C,{borderStyle:["solid"]}),t.items.map((o,s)=>e.jsxs(h.Fragment,{children:[e.jsx(ie,{...o,showChordTimes:t.showChordTimes}),e.jsx(C,{borderStyle:["dashed","solid"],display:[s<t.items.length-1?"block":"none","block"]})]},s)),e.jsx(j,{label:`Repeat ${t.times} times`,borderColor:r.chunks.item.chordsPattern.divider,children:e.jsxs(f,{size:"sm",fontWeight:"bold",position:"absolute",top:"50%",right:"0",transform:"translate(0%, -50%)",zIndex:1,backgroundColor:r.chunks.item.chordsPattern.chord.times.background,color:r.chunks.item.chordsPattern.chord.times.color,children:["x",t.times]})})]})},m=t=>{const{song:r}=a();return e.jsxs(c,{direction:"row",alignItems:"center",gap:"1em",position:"relative",children:[e.jsx(u,{size:"md",color:r.chunks.item.stringsPattern.stringNames,children:t.name}),e.jsx(c,{direction:"row",position:"absolute",left:"30px",alignItems:"center",gap:"5px",children:t.frets.map((o,s)=>o==="-"?e.jsx(d,{width:"1.4em",children:e.jsx(x,{borderWidth:"thin",borderColor:r.chunks.item.stringsPattern.filler})}):o==="|"?e.jsx(d,{color:r.chunks.item.stringsPattern.filler,children:"|"}):e.jsx(d,{width:"1.4em",children:e.jsx(y,{size:"1.4em",fontWeight:"bold",borderWidth:"thin",backgroundColor:r.chunks.item.stringsPattern.fret.background,borderColor:r.chunks.item.stringsPattern.fret.border,color:r.chunks.item.stringsPattern.fret.text,children:o},s)}))})]})},ae=t=>{const{song:r}=a(),o=[["-"],["-"],["-"],["-"],["-"],["-"],["-"]];return t.items.forEach(s=>{s.forEach(i=>{const{string:p,fret:g}=i;o[p].push(g)});const n=Math.max(...o.map(i=>i.length));o.forEach(i=>{i.length!=n&&i.push("-")})}),e.jsxs(c,{direction:"column",gap:"0.5em",width:"100%",overflow:"scroll",children:[e.jsx(m,{name:"e",frets:o[6]}),e.jsx(m,{name:"B",frets:o[5]}),e.jsx(m,{name:"G",frets:o[4]}),e.jsx(m,{name:"D",frets:o[3]}),e.jsx(m,{name:"A",frets:o[2]}),e.jsx(m,{name:"E",frets:o[1]}),e.jsx(x,{borderColor:r.chunks.item.stringsPattern.divider})]})},de=t=>{const{song:r}=a();return e.jsx(u,{as:"h3",size:"md",textAlign:"center",textDecoration:"underline",textTransform:"capitalize",color:r.chunks.item.title,children:e.jsxs(l,{as:"span",position:"relative",fontSize:["lg","xl"],children:[t.name,t.times>1&&e.jsxs(f,{size:"sm",position:"absolute",bottom:0,right:0,transform:"translate(120%, 20%)",backgroundColor:r.chunks.item.times.background,color:r.chunks.item.times.color,children:["x",t.times]})]})})},le=t=>e.jsx(c,{direction:"column",alignItems:"center",gap:"1em",children:t.chunks.map((r,o)=>t.type==="chords"?e.jsx(ce,{...r,showChordTimes:t.showChordTimes},o):t.type==="strings"?e.jsx(ae,{...r,showChordTimes:t.showChordTimes},o):(console.warn(`Unimplemented pattern type "${t.type}`),e.jsx(e.Fragment,{})))}),he=t=>{const{song:r}=a();return e.jsx(H,{allowMultiple:!0,padding:"1.5em 1em",borderRadius:"1rem",defaultIndex:t.songSegmentsOrder.map((o,s)=>s),backgroundColor:r.chunks.background,children:t.songSegmentsOrder.map((o,s)=>{const n=t.songSegments[o];console.assert(n!==void 0,`Failed to find song segment data for "${o}"`);const i=Object.entries(t.songSegments).some(([p,g])=>g.type==="chords"&&g.chunks.some(T=>T.items.some(z=>z.chordTimes>1)));return e.jsxs(O,{borderColor:r.chunks.divider,children:[e.jsxs(F,{display:"flex",justifyContent:"flex-end",alignItems:"center",position:"relative",pt:["10px","15px"],pb:["10px","15px"],mb:["0px","5px"],backgroundColor:"blackAlpha.100",_hover:{backgroundColor:"blackAlpha.100"},children:[e.jsx(d,{position:"absolute",left:"50%",transform:"translateX(-50%)",textAlign:"center",width:"100%",children:e.jsx(de,{...n,showChordTimes:i})}),e.jsx(_,{color:r.chunks.item.title})]}),e.jsx(G,{children:e.jsx(le,{...n,showChordTimes:i})})]},`${o}-${s}`)})})},me=t=>{const{song:r}=a();return e.jsxs(U,{maxW:["100vw","5xl"],padding:["25px 10px","2em 1em"],borderRadius:["0em","0.5em"],height:"100%",overflowY:"scroll",backgroundColor:r.background,children:[e.jsx(Q,{directory:t.directory,title:t.title,artists:t.artists,capo:t.capo,type:t.type,contributors:t.contributors}),e.jsx(he,{songSegments:t.songSegments,songSegmentsOrder:t.songSegmentsOrder}),e.jsx(re,{resources:t.resources})]})},pe=()=>{const{directory:t}=N(),{song:r}=a(),[o,s]=h.useState(null);return h.useLayoutEffect(()=>Z(r.background),[r.background]),h.useEffect(()=>{t&&fetch(`/songs/${t}/config.json`).then(n=>n.ok?n.json():(console.error(`Song ${t} not found`),null)).then(n=>{n&&s(n)})},[t]),o?e.jsx(me,{directory:t||"",title:o.title,artists:o.artists,capo:o.capo,songSegments:o.songSegments,songSegmentsOrder:o.songSegmentsOrder,resources:o.resources,type:o.type,contributors:o.contributors}):e.jsx("div",{children:"Loading song..."})};export{pe as SongPage,pe as default};
