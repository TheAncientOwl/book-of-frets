import{j as e,F as c,B as a,S,I as P,k as y,T as l,H as g,l as b,e as I,h as j,g as A,A as T,L as z,m as x,P as L,n as R,o as f,p as W,q as $,r as E,s as M,t as D,v as O,w as F,x as H,y as B,C as _}from"./chakra-DhaWsmo1.js";import{r as h,u as G}from"./react-Djq6mIGJ.js";import{u as d,a as U}from"./index-fZHhh-Mk.js";import{G as N,a as Y,I as Z,b as k}from"./react-icons-Bz7ZZPxh.js";import{C as q}from"./Chord-BB8AUxBf.js";import"./react-virtualized-BDZWj5_A.js";const V={acoustic:e.jsx(Y,{}),electric:e.jsx(N,{})},X=t=>{const{song:s}=d(),[r,n]=h.useState(!1);return e.jsxs(c,{direction:"column",alignItems:"center",mb:"15px",children:[e.jsxs(a,{position:"relative",width:["70px","80px"],height:["70px","80px"],mb:["5px"],children:[e.jsx(S,{isLoaded:r,width:"100%",height:"100%",borderRadius:"10px",children:e.jsx(P,{src:`/songs/${t.directory}/cover.webp`,alt:`${t.title} cover`,width:"100%",height:"100%",objectFit:"cover",borderRadius:"10px",borderStyle:"solid",borderWidth:"thin",onLoad:()=>n(!0),borderColor:s.header.coverBorder})}),e.jsx(y,{position:"absolute",right:"0",top:"0",transform:"translate(50%, -50%)",size:"1em",padding:"15px",fontWeight:"bold",borderWidth:"thin",backgroundColor:s.capo.background,borderColor:s.capo.border,color:s.capo.text,children:e.jsxs(c,{alignItems:"end",children:[e.jsx(l,{fontSize:"sm",children:"C"}),e.jsx(l,{fontSize:"xs",children:t.capo})]})})]}),e.jsx(g,{noOfLines:1,as:"h1",size:["sm","md"],mb:["5px"],textAlign:"center",color:s.header.title,children:t.title}),e.jsx(g,{noOfLines:1,as:"h2",size:["xs","sm"],mb:["5px"],fontStyle:"italic",textAlign:"center",color:s.header.artists,children:t.artists.map((i,o)=>e.jsxs(a,{as:"span",children:[i," ",o<t.artists.length-1&&", "]},o))}),e.jsx(c,{justifyContent:"center",color:s.header.typeTags,children:t.type.map((i,o)=>e.jsx(h.Fragment,{children:e.jsx(b,{label:i,children:V[i]})},o))})]})},J=t=>{try{const s=new URL(t);return s.hostname==="www.youtube.com"||s.hostname==="youtube.com"||s.hostname==="m.youtube.com"?s.pathname.startsWith("/shorts/")?s.pathname.split("/")[2]:s.searchParams.get("v"):s.hostname==="youtu.be"?s.pathname.slice(1):null}catch{return null}},K=t=>{const{song:s}=d(),r=J(t.link),[n,i]=h.useState(!1);return e.jsx(I,{children:e.jsxs(c,{direction:"column",alignItems:"center",textAlign:"center",children:[e.jsx(j,{as:Z,color:s.resources.item.note}),e.jsx(A,{isExternal:!0,href:t.link.replaceAll("{book-of-frets}","/"),size:["xs","sm"],color:s.resources.item.alias,children:t.alias}),t.author!=="-"&&e.jsxs(l,{fontStyle:"italic",textAlign:"center",fontSize:["small","sm"],color:s.resources.item.author,children:["by ",t.author]}),r&&e.jsx(a,{width:"100%",maxW:"400px",my:2,overflow:"hidden",borderRadius:"10px",children:e.jsx(T,{ratio:16/9,children:e.jsx(S,{isLoaded:n,height:"100%",width:"100%",children:e.jsx("iframe",{src:`https://www.youtube.com/embed/${r}`,title:t.alias,allow:"accelerometer;  clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,onLoad:()=>i(!0),style:{width:"100%",height:"100%",border:"none"}})})})})]})})},Q=t=>{const{song:s}=d();return e.jsxs(a,{mt:"1em",padding:"1em 1.25em",children:[e.jsx(g,{as:"h1",size:"md",mb:"1em",textAlign:"center",children:e.jsxs(c,{justifyContent:"center",alignItems:"center",gap:"0.25em",color:s.resources.title,children:[e.jsx(j,{as:k}),"Resources",e.jsx(j,{as:k})]})}),t.resources.length===0&&e.jsx(l,{textAlign:"center",children:"Nothing here yet"}),e.jsx(z,{children:t.resources.map((r,n)=>e.jsxs(h.Fragment,{children:[e.jsx(K,{...r}),n<t.resources.length-1&&e.jsx(x,{mt:"1em",mb:"1em"})]},n))})]})},ee=["De","Ue"],te="e",se="-",re=t=>{const{song:s}=d(),{chordsIndex:r}=U();return e.jsxs(c,{direction:"column",alignItems:"center",children:[e.jsx(c,{direction:"row",gap:"1em",mb:"0.6em",children:t.chordIDs.map((n,i)=>{const o=r[n];return console.assert(o!==void 0,`Missing chord index for ID '${n}'`),e.jsx(a,{as:"span",children:e.jsxs(L,{children:[e.jsx(R,{children:e.jsx(f,{fontWeight:"bold",cursor:"pointer",backgroundColor:s.chunks.item.chordsPattern.chord.background,color:s.chunks.item.chordsPattern.chord.color,children:n!==se?o.name:"-"})}),e.jsx(W,{children:e.jsxs($,{zIndex:1,backgroundColor:s.chunks.item.chordsPattern.chord.segment.popover.background,borderColor:s.chunks.item.chordsPattern.chord.segment.popover.border,children:[e.jsx(E,{backgroundColor:s.chunks.item.chordsPattern.chord.segment.popover.arrow}),e.jsx(M,{color:s.chunks.item.chordsPattern.chord.segment.popover.closeButton}),e.jsx(c,{justifyContent:"center",padding:"25px",children:e.jsx(q,{name:o.name,frets:o.frets})})]})})]})},i)})}),t.showChordTimes&&e.jsx(b,{label:`Strum ${t.chordTimes} times`,children:e.jsxs(l,{fontSize:"xs",fontWeight:"bold",color:s.chunks.item.chordsPattern.chord.segment.times,children:["x",t.chordTimes]})}),e.jsx(a,{position:"relative",mt:"0.4em",children:e.jsx(c,{direction:"row",gap:"0.5em",alignItems:"end",color:s.chunks.item.chordsPattern.chord.segment.pattern,children:t.strummingPattern.map((n,i)=>e.jsx(l,{fontWeight:"bold",textDecoration:ee.includes(n)?"underline":"none",children:n.replace(te,"")},i))})})]})},C=t=>{const{song:s}=d();return e.jsx(x,{orientation:"vertical",height:["0px","80px"],borderWidth:"thin",mt:["15px","0px"],mb:["15px","0px"],borderColor:s.chunks.item.chordsPattern.divider,...t})},ne=t=>{const{song:s}=d();return e.jsxs(a,{width:"100%",position:"relative",display:["box","flex"],gap:"1em",alignItems:"center",justifyContent:"center",children:[e.jsx(C,{borderStyle:["solid"]}),t.items.map((r,n)=>e.jsxs(h.Fragment,{children:[e.jsx(re,{...r,showChordTimes:t.showChordTimes}),e.jsx(C,{borderStyle:["dashed","solid"],display:[n<t.items.length-1?"block":"none","block"]})]},n)),e.jsx(b,{label:`Repeat ${t.times} times`,borderColor:s.chunks.item.chordsPattern.divider,children:e.jsxs(f,{size:"sm",fontWeight:"bold",position:"absolute",top:"50%",right:"0",transform:"translate(0%, -50%)",zIndex:1,backgroundColor:s.chunks.item.chordsPattern.chord.times.background,color:s.chunks.item.chordsPattern.chord.times.color,children:["x",t.times]})})]})},m=t=>{const{song:s}=d();return e.jsxs(c,{direction:"row",alignItems:"center",gap:"1em",position:"relative",children:[e.jsx(g,{size:"md",color:s.chunks.item.stringsPattern.stringNames,children:t.name}),e.jsx(c,{direction:"row",position:"absolute",left:"30px",alignItems:"center",gap:"5px",children:t.frets.map((r,n)=>r==="-"?e.jsx(a,{width:"1.4em",children:e.jsx(x,{borderWidth:"thin",borderColor:s.chunks.item.stringsPattern.filler})}):r==="|"?e.jsx(a,{color:s.chunks.item.stringsPattern.filler,children:"|"}):e.jsx(a,{width:"1.4em",children:e.jsx(y,{size:"1.4em",fontWeight:"bold",borderWidth:"thin",backgroundColor:s.chunks.item.stringsPattern.fret.background,borderColor:s.chunks.item.stringsPattern.fret.border,color:s.chunks.item.stringsPattern.fret.text,children:r},n)}))})]})},oe=t=>{const{song:s}=d(),r=[["-"],["-"],["-"],["-"],["-"],["-"],["-"]];return t.items.forEach(n=>{n.forEach(o=>{const{string:p,fret:u}=o;r[p].push(u)});const i=Math.max(...r.map(o=>o.length));r.forEach(o=>{o.length!=i&&o.push("-")})}),e.jsxs(c,{direction:"column",gap:"0.5em",width:"100%",overflow:"scroll",children:[e.jsx(m,{name:"e",frets:r[6]}),e.jsx(m,{name:"B",frets:r[5]}),e.jsx(m,{name:"G",frets:r[4]}),e.jsx(m,{name:"D",frets:r[3]}),e.jsx(m,{name:"A",frets:r[2]}),e.jsx(m,{name:"E",frets:r[1]}),e.jsx(x,{borderColor:s.chunks.item.stringsPattern.divider})]})},ie=t=>{const{song:s}=d();return e.jsx(g,{as:"h3",size:"md",textAlign:"center",textDecoration:"underline",textTransform:"capitalize",color:s.chunks.item.title,children:e.jsxs(l,{as:"span",position:"relative",fontSize:["lg","xl"],children:[t.name,t.times>1&&e.jsxs(f,{size:"sm",position:"absolute",bottom:0,right:0,transform:"translate(120%, 20%)",backgroundColor:s.chunks.item.times.background,color:s.chunks.item.times.color,children:["x",t.times]})]})})},ce=t=>e.jsx(c,{direction:"column",alignItems:"center",gap:"1em",children:t.chunks.map((s,r)=>t.type==="chords"?e.jsx(ne,{...s,showChordTimes:t.showChordTimes},r):t.type==="strings"?e.jsx(oe,{...s,showChordTimes:t.showChordTimes},r):(console.warn(`Unimplemented pattern type "${t.type}`),e.jsx(e.Fragment,{})))}),ae=t=>{const{song:s}=d();return e.jsx(D,{allowMultiple:!0,padding:"1.5em 1em",borderRadius:"1rem",defaultIndex:t.songSegmentsOrder.map((r,n)=>n),backgroundColor:s.chunks.background,children:t.songSegmentsOrder.map((r,n)=>{const i=t.songSegments[r];console.assert(i!==void 0,`Failed to find song segment data for "${r}"`);const o=Object.entries(t.songSegments).some(([p,u])=>u.type==="chords"&&u.chunks.some(w=>w.items.some(v=>v.chordTimes>1)));return e.jsxs(O,{borderColor:s.chunks.divider,children:[e.jsxs(F,{display:"flex",justifyContent:"flex-end",alignItems:"center",position:"relative",pt:["10px","15px"],pb:["10px","15px"],mb:["0px","5px"],backgroundColor:"blackAlpha.100",_hover:{backgroundColor:"blackAlpha.100"},children:[e.jsx(a,{position:"absolute",left:"50%",transform:"translateX(-50%)",textAlign:"center",width:"100%",children:e.jsx(ie,{...i,showChordTimes:o})}),e.jsx(H,{color:s.chunks.item.title})]}),e.jsx(B,{children:e.jsx(ce,{...i,showChordTimes:o})})]},`${r}-${n}`)})})},de=t=>{const{song:s}=d();return e.jsxs(_,{maxW:["100vw","5xl"],padding:["25px 10px","2em 1em"],borderRadius:"1rem",height:"100%",overflowY:"scroll",backgroundColor:s.background,children:[e.jsx(X,{directory:t.directory,title:t.title,artists:t.artists,capo:t.capo,type:t.type}),e.jsx(ae,{songSegments:t.songSegments,songSegmentsOrder:t.songSegmentsOrder}),e.jsx(Q,{resources:t.resources})]})},je=()=>{const{directory:t}=G(),[s,r]=h.useState(null);return h.useEffect(()=>{t&&fetch(`/songs/${t}/config.json`).then(n=>n.ok?n.json():(console.error(`Song ${t} not found`),null)).then(n=>{n&&r(n)})},[t]),s?e.jsx(de,{directory:t||"",title:s.title,artists:s.artists,capo:s.capo,songSegments:s.songSegments,songSegmentsOrder:s.songSegmentsOrder,resources:s.resources,type:s.type}):e.jsx("div",{children:"Loading song..."})};export{je as SongPage,je as default};
