import{j as e,f as y,F as i,i as u,h as w,T as m,B as o,A as S,l as b,m as h,H as d,n as p,C as I,d as T,o as v,L as z}from"./chakra-DbUZ3UDO.js";import{r as l,u as W}from"./react-BTPqQck7.js";import{I as $,a as j,G as k,b as A}from"./react-icons-BLrvkj5A.js";import{u as F}from"./index-BrjP_ZQ0.js";const D=s=>{try{const t=new URL(s);return t.hostname==="www.youtube.com"||t.hostname==="youtube.com"||t.hostname==="m.youtube.com"?t.pathname.startsWith("/shorts/")?t.pathname.split("/")[2]:t.searchParams.get("v"):t.hostname==="youtu.be"?t.pathname.slice(1):null}catch{return null}},E=s=>{const t=D(s.link);return e.jsx(y,{children:e.jsxs(i,{direction:"column",alignItems:"center",textAlign:"center",children:[e.jsx(u,{as:$}),e.jsx(w,{isExternal:!0,href:s.link,size:["xs","sm"],textColor:"CaptionText",children:s.alias}),e.jsxs(m,{fontStyle:"italic",textAlign:"center",fontSize:["small","sm"],children:["by ",s.author]}),t?e.jsx(o,{width:"100%",maxW:"400px",my:2,children:e.jsx(S,{ratio:16/9,children:e.jsx("iframe",{src:`https://www.youtube.com/embed/${t}`,title:s.alias,allow:"accelerometer;  clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})})}):null]})})},L="-",R=s=>{const{chordsIndex:t}=F();return e.jsxs(i,{direction:"column",alignItems:"center",children:[e.jsx(i,{direction:"row",gap:"1em",mb:"0.6em",children:s.chordIDs.map((n,r)=>{const a=t[n];return console.assert(a!==void 0,`Missing chord index for ID '${n}'`),e.jsx(o,{as:"span",children:e.jsx(b,{backgroundColor:"green.200",fontWeight:"bold",children:n!==L?a.name:"-"})},r)})}),s.showChordTimes&&e.jsxs(m,{fontSize:"xs",fontWeight:"bold",children:["x",s.chordTimes]}),e.jsx(o,{position:"relative",mt:"0.4em",children:e.jsx(i,{direction:"row",gap:"0.5em",alignItems:"end",children:s.strummingPattern.map((n,r)=>e.jsx(m,{fontWeight:"bold",children:n},r))})})]})},f=()=>e.jsx(h,{orientation:"vertical",height:["0px","80px"],borderColor:"gray.600",borderWidth:"thin",borderStyle:["dashed","solid"],mt:["15px","0px"],mb:["15px","0px"]}),O=s=>e.jsxs(o,{width:"100%",position:"relative",display:["box","flex"],gap:"1em",alignItems:"center",justifyContent:"center",children:[e.jsx(f,{}),s.segments.map((t,n)=>e.jsxs(l.Fragment,{children:[e.jsx(R,{...t,showChordTimes:s.showChordTimes}),e.jsx(f,{})]},n)),e.jsxs(b,{size:"sm",fontWeight:"bold",backgroundColor:"green.200",position:"absolute",top:"50%",right:"0",transform:"translate(0%, -50%)",zIndex:1,children:["x",s.times]})]}),c=s=>e.jsxs(i,{direction:"row",alignItems:"center",gap:"1em",position:"relative",children:[e.jsx(d,{size:"md",children:s.name}),e.jsx(i,{direction:"row",position:"absolute",left:"30px",alignItems:"center",gap:"5px",children:s.frets.map((t,n)=>e.jsx(o,{children:t==="-"?e.jsx(o,{width:"1.4em",children:e.jsx(h,{borderColor:"black",borderWidth:"thin"})}):e.jsx(o,{width:"1.4em",children:e.jsx(p,{size:"1.4em",bg:"green.300",color:"green.900",fontWeight:"bold",borderColor:"green.900",borderWidth:"thin",children:t},n)})}))})]}),P=s=>{const t=[["-"],["-"],["-"],["-"],["-"],["-"],["-"]];return s.segments.forEach(n=>{n.forEach(a=>{const{string:x,fret:g}=a;t[x].push(g)});const r=Math.max(...t.map(a=>a.length));t.forEach(a=>{a.length!=r&&a.push("-")})}),e.jsxs(i,{direction:"column",gap:"0.5em",width:"100%",overflow:"scroll",children:[e.jsx(c,{name:"E",frets:t[6]}),e.jsx(c,{name:"B",frets:t[5]}),e.jsx(c,{name:"G",frets:t[4]}),e.jsx(c,{name:"D",frets:t[3]}),e.jsx(c,{name:"A",frets:t[2]}),e.jsx(c,{name:"E",frets:t[1]}),e.jsx(h,{borderColor:"green.900"})]})},M=s=>e.jsxs(o,{alignItems:"center",mb:"1em",children:[e.jsx(d,{as:"h3",size:"md",mb:"1em",textAlign:"center",textDecoration:"underline",textTransform:"capitalize",children:s.name}),e.jsx(i,{direction:"column",alignItems:"center",gap:"1em",children:s.patterns.map((t,n)=>s.type==="chords"?e.jsx(O,{...t,showChordTimes:s.showChordTimes},n):s.type==="strings"?e.jsx(P,{...t,showChordTimes:s.showChordTimes},n):(console.warn(`Unimplemented pattern type "${s.type}`),e.jsx(e.Fragment,{})))})]}),G={acoustic:e.jsx(A,{}),electric:e.jsx(k,{})},H=s=>e.jsxs(I,{maxW:["100vw","5xl"],backgroundColor:"#237738ff",padding:["25px 10px","2em 1em"],borderRadius:"1rem",children:[e.jsxs(i,{direction:"column",alignItems:"center",mb:"15px",children:[e.jsxs(o,{position:"relative",width:["70px","80px"],height:["70px","80px"],mb:["5px"],children:[e.jsx(T,{src:`/book-of-frets/songs/${s.directory}/cover.jpeg`,alt:`${s.title} cover`,width:"100%",height:"100%",objectFit:"cover",borderRadius:"10px",borderStyle:"solid"}),e.jsx(p,{position:"absolute",right:"0",top:"0",transform:"translate(50%, -50%)",size:"1em",padding:"15px",bg:"green.300",color:"green.900",fontWeight:"bold",borderColor:"green.400",borderWidth:"thin",children:e.jsxs(i,{alignItems:"end",children:[e.jsx(m,{fontSize:"sm",children:"C"}),e.jsx(m,{fontSize:"xs",children:s.capo})]})})]}),e.jsx(d,{noOfLines:1,as:"h1",size:["sm","md"],mb:["5px"],color:"CaptionText",textAlign:"center",children:s.title}),e.jsx(d,{noOfLines:1,as:"h2",size:["xs","sm"],mb:["5px"],fontStyle:"italic",textAlign:"center",children:s.artists.map((t,n)=>e.jsxs(o,{as:"span",children:[t," ",n<s.artists.length-1&&", "]},n))}),e.jsx(i,{justifyContent:"center",children:s.type.map((t,n)=>e.jsx(l.Fragment,{children:e.jsx(v,{label:t,children:G[t]})},n))})]}),e.jsx(i,{direction:"column",gap:"5px",bgColor:"blackAlpha.400",padding:"1.5em 1em",borderRadius:"1rem",children:s.songSegmentsOrder.map((t,n)=>{const r=s.songSegments[t];return console.assert(r!==void 0,`Failed to find song segment data for "${t}"`),e.jsxs(l.Fragment,{children:[e.jsx(M,{...r,showChordTimes:Object.entries(s.songSegments).some(([a,x])=>x.type==="chords"&&x.patterns.some(g=>g.segments.some(C=>C.chordTimes>1)))}),e.jsx(h,{borderColor:"gray.600",mb:"1em"})]},`${t}-${n}`)})}),e.jsxs(o,{mt:"1em",padding:"1em 1.25em",children:[e.jsx(d,{as:"h1",size:"md",mb:"1em",textAlign:"center",children:e.jsxs(i,{justifyContent:"center",alignItems:"center",gap:"0.25em",children:[e.jsx(u,{as:j}),"Resources",e.jsx(u,{as:j})]})}),e.jsx(z,{children:s.resources.map((t,n)=>e.jsxs(l.Fragment,{children:[e.jsx(E,{...t}),n<s.resources.length-1&&e.jsx(h,{mt:"1em",mb:"1em",color:"gray.600"})]},n))})]})]}),Y=()=>{const{directory:s}=W(),[t,n]=l.useState(null);return l.useEffect(()=>{s&&fetch(`/book-of-frets/songs/${s}/config.json`).then(r=>r.ok?r.json():(console.error(`Song ${s} not found`),null)).then(r=>{r&&n(r)})},[s]),t?e.jsx(H,{directory:s||"",title:t.title,artists:t.artists,capo:t.capo,songSegments:t.songSegments,songSegmentsOrder:t.songSegmentsOrder,resources:t.resources,type:t.type}):e.jsx("div",{children:"Loading song..."})};export{Y as SongPage,Y as default};
