import{j as e,F as o,B as a,P as S,l as I,m as j,n as v,o as T,p as z,q as f,T as d,r as h,H as m,s as C,S as y,d as L,f as P,i as u,h as $,A as k,L as A,C as R}from"./chakra-C0i0__6Y.js";import{r as c,u as W}from"./react-BTPqQck7.js";import{u as F}from"./index-BmxqrfEP.js";import{C as D}from"./Chord-DEICziQ2.js";import{G as E,a as O,I as M,b}from"./react-icons-DpBoED0Q.js";const G="-",H=t=>{const{chordsIndex:s}=F();return e.jsxs(o,{direction:"column",alignItems:"center",children:[e.jsx(o,{direction:"row",gap:"1em",mb:"0.6em",children:t.chordIDs.map((r,n)=>{const i=s[r];return console.assert(i!==void 0,`Missing chord index for ID '${r}'`),e.jsx(a,{as:"span",children:e.jsxs(S,{children:[e.jsx(I,{children:e.jsx(j,{backgroundColor:"green.200",fontWeight:"bold",cursor:"pointer",children:r!==G?i.name:"-"})}),e.jsxs(v,{children:[e.jsx(T,{}),e.jsx(z,{}),e.jsx(o,{justifyContent:"center",padding:"25px",children:e.jsx(D,{name:i.name,frets:i.frets})})]})]})},n)})}),t.showChordTimes&&e.jsx(f,{label:`Strum ${t.chordTimes} times`,children:e.jsxs(d,{fontSize:"xs",fontWeight:"bold",children:["x",t.chordTimes]})}),e.jsx(a,{position:"relative",mt:"0.4em",children:e.jsx(o,{direction:"row",gap:"0.5em",alignItems:"end",children:t.strummingPattern.map((r,n)=>e.jsx(d,{fontWeight:"bold",children:r},n))})})]})},p=()=>e.jsx(h,{orientation:"vertical",height:["0px","80px"],borderColor:"gray.600",borderWidth:"thin",borderStyle:["dashed","solid"],mt:["15px","0px"],mb:["15px","0px"]}),B=t=>e.jsxs(a,{width:"100%",position:"relative",display:["box","flex"],gap:"1em",alignItems:"center",justifyContent:"center",children:[e.jsx(p,{}),t.segments.map((s,r)=>e.jsxs(c.Fragment,{children:[e.jsx(H,{...s,showChordTimes:t.showChordTimes}),e.jsx(p,{})]},r)),e.jsx(f,{label:`Repeat ${t.times} times`,children:e.jsxs(j,{size:"sm",fontWeight:"bold",backgroundColor:"green.200",position:"absolute",top:"50%",right:"0",transform:"translate(0%, -50%)",zIndex:1,children:["x",t.times]})})]}),l=t=>e.jsxs(o,{direction:"row",alignItems:"center",gap:"1em",position:"relative",children:[e.jsx(m,{size:"md",children:t.name}),e.jsx(o,{direction:"row",position:"absolute",left:"30px",alignItems:"center",gap:"5px",children:t.frets.map((s,r)=>s==="-"?e.jsx(a,{width:"1.4em",children:e.jsx(h,{borderColor:"black",borderWidth:"thin"})}):s==="|"?e.jsx(a,{children:"|"}):e.jsx(a,{width:"1.4em",children:e.jsx(C,{size:"1.4em",bg:"green.300",color:"green.900",fontWeight:"bold",borderColor:"green.900",borderWidth:"thin",children:s},r)}))})]}),U=t=>{const s=[["-"],["-"],["-"],["-"],["-"],["-"],["-"]];return t.segments.forEach(r=>{r.forEach(i=>{const{string:x,fret:g}=i;s[x].push(g)});const n=Math.max(...s.map(i=>i.length));s.forEach(i=>{i.length!=n&&i.push("-")})}),e.jsxs(o,{direction:"column",gap:"0.5em",width:"100%",overflow:"scroll",children:[e.jsx(l,{name:"E",frets:s[6]}),e.jsx(l,{name:"B",frets:s[5]}),e.jsx(l,{name:"G",frets:s[4]}),e.jsx(l,{name:"D",frets:s[3]}),e.jsx(l,{name:"A",frets:s[2]}),e.jsx(l,{name:"E",frets:s[1]}),e.jsx(h,{borderColor:"green.900"})]})},_=t=>e.jsxs(a,{alignItems:"center",mb:"1em",children:[e.jsx(m,{as:"h3",size:"md",mb:"1em",textAlign:"center",textDecoration:"underline",textTransform:"capitalize",children:e.jsxs(a,{as:"span",position:"relative",children:[t.name,t.times>1&&e.jsxs(j,{size:"sm",backgroundColor:"green.300",position:"absolute",bottom:0,right:0,transform:"translate(120%, 20%)",children:["x",t.times]})]})}),e.jsx(o,{direction:"column",alignItems:"center",gap:"1em",children:t.patterns.map((s,r)=>t.type==="chords"?e.jsx(B,{...s,showChordTimes:t.showChordTimes},r):t.type==="strings"?e.jsx(U,{...s,showChordTimes:t.showChordTimes},r):(console.warn(`Unimplemented pattern type "${t.type}`),e.jsx(e.Fragment,{})))})]}),q={acoustic:e.jsx(O,{}),electric:e.jsx(E,{})},N=t=>{const[s,r]=c.useState(!1);return e.jsxs(o,{direction:"column",alignItems:"center",mb:"15px",children:[e.jsxs(a,{position:"relative",width:["70px","80px"],height:["70px","80px"],mb:["5px"],children:[e.jsx(y,{isLoaded:s,width:"100%",height:"100%",borderRadius:"10px",children:e.jsx(L,{src:`/book-of-frets/songs/${t.directory}/cover.jpeg`,alt:`${t.title} cover`,width:"100%",height:"100%",objectFit:"cover",borderRadius:"10px",borderStyle:"solid",onLoad:()=>r(!0)})}),e.jsx(C,{position:"absolute",right:"0",top:"0",transform:"translate(50%, -50%)",size:"1em",padding:"15px",bg:"green.300",color:"green.900",fontWeight:"bold",borderColor:"green.400",borderWidth:"thin",children:e.jsxs(o,{alignItems:"end",children:[e.jsx(d,{fontSize:"sm",children:"C"}),e.jsx(d,{fontSize:"xs",children:t.capo})]})})]}),e.jsx(m,{noOfLines:1,as:"h1",size:["sm","md"],mb:["5px"],color:"CaptionText",textAlign:"center",children:t.title}),e.jsx(m,{noOfLines:1,as:"h2",size:["xs","sm"],mb:["5px"],fontStyle:"italic",textAlign:"center",children:t.artists.map((n,i)=>e.jsxs(a,{as:"span",children:[n," ",i<t.artists.length-1&&", "]},i))}),e.jsx(o,{justifyContent:"center",children:t.type.map((n,i)=>e.jsx(c.Fragment,{children:e.jsx(f,{label:n,children:q[n]})},i))})]})},V=t=>{try{const s=new URL(t);return s.hostname==="www.youtube.com"||s.hostname==="youtube.com"||s.hostname==="m.youtube.com"?s.pathname.startsWith("/shorts/")?s.pathname.split("/")[2]:s.searchParams.get("v"):s.hostname==="youtu.be"?s.pathname.slice(1):null}catch{return null}},Y=t=>{const s=V(t.link),[r,n]=c.useState(!1);return e.jsx(P,{children:e.jsxs(o,{direction:"column",alignItems:"center",textAlign:"center",children:[e.jsx(u,{as:M}),e.jsx($,{isExternal:!0,href:t.link,size:["xs","sm"],textColor:"CaptionText",children:t.alias}),e.jsxs(d,{fontStyle:"italic",textAlign:"center",fontSize:["small","sm"],children:["by ",t.author]}),s?e.jsx(a,{width:"100%",maxW:"400px",my:2,overflow:"hidden",borderRadius:"10px",children:e.jsx(k,{ratio:16/9,children:e.jsx(y,{isLoaded:r,height:"100%",width:"100%",children:e.jsx("iframe",{src:`https://www.youtube.com/embed/${s}`,title:t.alias,allow:"accelerometer;  clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,onLoad:()=>n(!0),style:{width:"100%",height:"100%",border:"none"}})})})}):null]})})},J=t=>e.jsxs(a,{mt:"1em",padding:"1em 1.25em",children:[e.jsx(m,{as:"h1",size:"md",mb:"1em",textAlign:"center",children:e.jsxs(o,{justifyContent:"center",alignItems:"center",gap:"0.25em",children:[e.jsx(u,{as:b}),"Resources",e.jsx(u,{as:b})]})}),t.resources.length===0&&e.jsx(d,{textAlign:"center",children:"Nothing here yet"}),e.jsx(A,{children:t.resources.map((s,r)=>e.jsxs(c.Fragment,{children:[e.jsx(Y,{...s}),r<t.resources.length-1&&e.jsx(h,{mt:"1em",mb:"1em",color:"gray.600"})]},r))})]}),K=t=>e.jsxs(R,{maxW:["100vw","5xl"],backgroundColor:"#237738ff",padding:["25px 10px","2em 1em"],borderRadius:"1rem",children:[e.jsx(N,{directory:t.directory,title:t.title,artists:t.artists,capo:t.capo,type:t.type}),e.jsx(o,{direction:"column",gap:"5px",bgColor:"blackAlpha.400",padding:"1.5em 1em",borderRadius:"1rem",children:t.songSegmentsOrder.map((s,r)=>{const n=t.songSegments[s];return console.assert(n!==void 0,`Failed to find song segment data for "${s}"`),e.jsxs(c.Fragment,{children:[e.jsx(_,{...n,showChordTimes:Object.entries(t.songSegments).some(([i,x])=>x.type==="chords"&&x.patterns.some(g=>g.segments.some(w=>w.chordTimes>1)))}),e.jsx(h,{borderColor:"gray.600",mb:"1em"})]},`${s}-${r}`)})}),e.jsx(J,{resources:t.resources})]}),se=()=>{const{directory:t}=W(),[s,r]=c.useState(null);return c.useEffect(()=>{t&&fetch(`/book-of-frets/songs/${t}/config.json`).then(n=>n.ok?n.json():(console.error(`Song ${t} not found`),null)).then(n=>{n&&r(n)})},[t]),s?e.jsx(K,{directory:t||"",title:s.title,artists:s.artists,capo:s.capo,songSegments:s.songSegments,songSegmentsOrder:s.songSegmentsOrder,resources:s.resources,type:s.type}):e.jsx("div",{children:"Loading song..."})};export{se as SongPage,se as default};
