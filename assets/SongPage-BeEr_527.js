import{j as e,b as t,c as r,B as s,H as o,d as n,e as i,L as c,a,F as l,Q as d,I as h,g as m,T as x,R as u,U as p,W as g,X as j,a0 as b,a1 as f,Y as k,m as y,h as C,D as v,E as w,a2 as z,Z as I,a3 as S,_ as A,A as L}from"./chakra-Do366R1-.js";import{C as P}from"./Chord-BlMex5GR.js";import{u as $,a as W,s as D}from"./index-BiXePlRp.js";import{r as F,i as E}from"./react-DbiYpRmf.js";import{a as R,b as B,G as M,I as N,c as T}from"./react-icons-DGsbL8xG.js";import"./react-virtualized-Cq2ZoWce.js";const U=l=>{const{chordsIndex:d}=$(),{song:h}=W();return e.jsxs(t,{borderColor:h.chunks.divider,children:[e.jsxs(r,{display:"flex",justifyContent:"flex-end",alignItems:"center",position:"relative",pt:["10px","15px"],pb:["10px","15px"],mb:["0px","5px"],backgroundColor:"blackAlpha.100",_hover:{backgroundColor:"blackAlpha.100"},children:[e.jsx(s,{position:"absolute",left:"50%",transform:"translateX(-50%)",textAlign:"center",width:"100%",children:e.jsx(o,{as:"h3",size:"md",textDecoration:"underline",color:h.chunks.item.title,children:"Chords"})}),e.jsx(n,{color:h.chunks.item.title})]}),e.jsx(i,{children:e.jsx(c,{display:"flex",gap:"10px",overflowX:"auto",children:l.chordIDs.map(t=>{const r=d[t];return void 0===r?(console.error(`Missing chord config for ID ${t}`),null):e.jsx(a,{children:e.jsx(P,{...r,containerProps:{fontSize:["8px","10px","12px"]}})},t)})})})]})},X={acoustic:e.jsx(B,{}),electric:e.jsx(R,{})},_=t=>{const{song:r}=W(),[n,i]=F.useState(!1);return e.jsxs(l,{direction:"column",alignItems:"center",mb:"15px",children:[e.jsxs(s,{position:"relative",width:["70px","80px"],height:["70px","80px"],mb:["5px"],children:[e.jsx(d,{isLoaded:n,width:"100%",height:"100%",borderRadius:"10px",children:e.jsx(h,{src:`/songs/${t.directory}/cover-192x192.webp`,srcSet:`\n              /songs/${t.directory}/cover-64x64.webp   64w,\n              /songs/${t.directory}/cover-128x128.webp 128w,\n              /songs/${t.directory}/cover-192x192.webp 192w`,alt:`${t.title} cover`,width:"100%",height:"100%",objectFit:"cover",borderRadius:"10px",borderStyle:"solid",borderWidth:"thin",onLoad:()=>i(!0),borderColor:r.header.coverBorder})}),e.jsx(m,{position:"absolute",right:"0",top:"0",transform:"translate(50%, -50%)",size:"1em",padding:"15px",fontWeight:"bold",borderWidth:"thin",backgroundColor:r.capo.background,borderColor:r.capo.border,color:r.capo.text,children:e.jsxs(l,{alignItems:"end",children:[e.jsx(x,{fontSize:"sm",children:"C"}),e.jsx(x,{fontSize:"xs",children:t.capo})]})})]}),e.jsx(o,{noOfLines:1,as:"h1",size:["sm","md"],mb:["5px"],textAlign:"center",color:r.header.title,children:t.title}),e.jsx(o,{noOfLines:1,as:"h2",size:["xs","sm"],mb:["5px"],fontStyle:"italic",textAlign:"center",color:r.header.artists,children:t.artists.map((r,o)=>e.jsxs(s,{as:"span",children:[r," ",o<t.artists.length-1&&", "]},o))}),e.jsxs(u,{isLazy:!0,children:[e.jsx(p,{children:e.jsx(x,{as:"button",fontSize:"sm",mb:"10px",color:r.header.artists,_hover:{textDecoration:"underline",cursor:"pointer"},children:"Contributors"})}),e.jsxs(g,{textAlign:"center",borderColor:r.header.contributors.border,children:[e.jsx(j,{backgroundColor:r.header.contributors.heading}),e.jsx(b,{color:r.header.contributors.title}),e.jsx(f,{fontWeight:"bold",borderBottom:"1px solid",backgroundColor:r.header.contributors.heading,color:r.header.contributors.title,children:"Song contributed by"}),e.jsx(k,{backgroundColor:r.header.contributors.content,color:r.header.contributors.contributor,children:t.contributors.length>0?t.contributors.map((r,s)=>e.jsx(x,{fontSize:"sm",mb:s<t.contributors.length-1?"2px":"0",children:r},s)):e.jsx(x,{fontSize:"sm",fontStyle:"italic",children:"No contributors"})})]})]}),e.jsx(l,{justifyContent:"center",color:r.header.typeTags,children:t.type.map((t,r)=>e.jsx(F.Fragment,{children:e.jsx(y,{label:t,children:X[t]})},r))})]})};function G(e){return M({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M4.7134 7.12811L4.46682 7.69379C4.28637 8.10792 3.71357 8.10792 3.53312 7.69379L3.28656 7.12811C2.84706 6.11947 2.05545 5.31641 1.06767 4.87708L0.308047 4.53922C-0.102682 4.35653 -0.102682 3.75881 0.308047 3.57612L1.0252 3.25714C2.03838 2.80651 2.84417 1.97373 3.27612 0.930828L3.52932 0.319534C3.70578 -0.106511 4.29417 -0.106511 4.47063 0.319534L4.72382 0.930828C5.15577 1.97373 5.96158 2.80651 6.9748 3.25714L7.69188 3.57612C8.10271 3.75881 8.10271 4.35653 7.69188 4.53922L6.93228 4.87708C5.94451 5.31641 5.15288 6.11947 4.7134 7.12811ZM3.06361 21.6132C4.08854 15.422 6.31105 1.99658 21 1.99658C19.5042 4.99658 18.5 6.49658 17.5 7.49658L16.5 8.49658L18 9.49658C17 12.4966 14 15.9966 10 16.4966C7.33146 16.8301 5.66421 18.6635 4.99824 21.9966H3C3.02074 21.8722 3.0419 21.7443 3.06361 21.6132Z"},child:[]}]})(e)}const H=t=>{const{song:r}=W();return e.jsx(F.Fragment,{children:t.notes.length>0&&e.jsxs(s,{mt:"1em",padding:"1em 1.25em",children:[e.jsx(o,{as:"h1",size:"md",mb:"1em",textAlign:"center",children:e.jsxs(l,{justifyContent:"center",alignItems:"center",gap:"0.25em",color:r.notes.title,children:[e.jsx(C,{as:G}),"Notes",e.jsx(C,{as:G})]})}),e.jsx(c,{textAlign:"center",color:r.notes.title,children:t.notes.map((r,s)=>e.jsxs(F.Fragment,{children:[e.jsx(x,{children:r}),s<t.notes.length-1&&e.jsx(v,{mt:"1em",mb:"1em"})]},s))})]})})},O=t=>{const{song:r}=W(),o=(e=>{try{const t=new URL(e);return"www.youtube.com"===t.hostname||"youtube.com"===t.hostname||"m.youtube.com"===t.hostname?t.pathname.startsWith("/shorts/")?t.pathname.split("/")[2]:t.searchParams.get("v"):"youtu.be"===t.hostname?t.pathname.slice(1):null}catch{return null}})(t.link),[n,i]=F.useState(!1);return e.jsx(a,{children:e.jsxs(l,{direction:"column",alignItems:"center",textAlign:"center",children:[e.jsx(C,{as:N,color:r.res.item.note}),e.jsx(w,{isExternal:!0,href:t.link.replaceAll("{book-of-frets}","/"),size:["xs","sm"],color:r.res.item.alias,children:t.alias}),"-"!==t.author&&e.jsxs(x,{fontStyle:"italic",textAlign:"center",fontSize:["small","sm"],color:r.res.item.author,children:["by ",t.author]}),o&&e.jsx(s,{width:"100%",maxW:"400px",my:2,overflow:"hidden",borderRadius:"10px",children:e.jsx(z,{ratio:16/9,children:e.jsx(d,{isLoaded:n,height:"100%",width:"100%",children:e.jsx("iframe",{src:`https://www.youtube-nocookie.com/embed/${o}`,title:t.alias,allow:"accelerometer;  clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,onLoad:()=>i(!0),style:{width:"100%",height:"100%",border:"none"}})})})})]})})},Z=t=>{const{song:r}=W();return e.jsxs(s,{mt:"1em",padding:"1em 1.25em",children:[e.jsx(o,{as:"h1",size:"md",mb:"1em",textAlign:"center",children:e.jsxs(l,{justifyContent:"center",alignItems:"center",gap:"0.25em",color:r.res.title,children:[e.jsx(C,{as:T}),"Resources",e.jsx(C,{as:T})]})}),0===t.res.length&&e.jsx(x,{textAlign:"center",children:"Nothing here yet"}),e.jsx(c,{children:t.res.map((s,o)=>e.jsxs(F.Fragment,{children:[e.jsx(O,{...s}),e.jsx(a,{children:o<t.res.length-1&&e.jsx(v,{mt:"1em",mb:"1em",borderColor:r.res.item.alias})})]},o))})]})},Y=["De","Ue"],Q=t=>{const{song:r}=W(),{chordsIndex:o,songSettings:n}=$();return t.strumm>=t.strumms.length?(console.error({message:`Found strum index ${t.strumm} when strumms length is ${t.strumms.length}`,strumms:t.strumms}),null):e.jsxs(l,{direction:"column",alignItems:"center",justifyContent:"flex-end",children:[e.jsx(l,{direction:"column",gap:"5px",alignItems:t.align||"center",children:t.chordIDs.map((t,n)=>e.jsx(l,{direction:"row",gap:"1em",mb:"0.6em",children:t.map((t,n)=>{if("|"===t)return e.jsx(v,{height:"22px",borderWidth:"thin",borderColor:r.chunks.divider});const i=o[t];return console.assert(void 0!==i,`Missing chord index for ID '${t}'`),e.jsx(s,{as:"span",children:e.jsxs(u,{isLazy:!0,children:[e.jsx(p,{children:e.jsx(I,{as:"button",fontWeight:"bold",cursor:"pointer",backgroundColor:r.chunks.item.chordsPattern.chord.background,color:r.chunks.item.chordsPattern.chord.color,children:"-"!==t?i.name:"-"})}),e.jsx(S,{children:e.jsxs(g,{zIndex:1,backgroundColor:r.chunks.item.chordsPattern.chord.segment.popover.background,borderColor:r.chunks.item.chordsPattern.chord.segment.popover.border,children:[e.jsx(j,{backgroundColor:r.chunks.item.chordsPattern.chord.segment.popover.arrow}),e.jsx(b,{color:r.chunks.item.chordsPattern.chord.segment.popover.closeButton}),e.jsx(l,{justifyContent:"center",padding:"25px",children:e.jsx(P,{...i})})]})})]})},n)})},n))}),n.display.chordTimes.value&&e.jsx(y,{label:`Strum ${t.times} times`,children:e.jsxs(x,{fontSize:"xs",fontWeight:"bold",color:r.chunks.item.chordsPattern.chord.segment.times,children:["x",t.times]})}),n.display.strummingPattern.value&&e.jsx(s,{position:"relative",mt:"0.4em",children:e.jsx(l,{direction:"row",gap:"0.5em",alignItems:"end",color:r.chunks.item.chordsPattern.chord.segment.pattern,children:t.strumms[t.strumm].map((t,r)=>e.jsx(x,{fontWeight:"bold",textDecoration:Y.includes(t)?"underline":"none",children:t.replace("e","")},r))})})]})},q=t=>{const{song:r}=W();return e.jsx(v,{orientation:"vertical",height:["0px","auto"],width:["70%","0px"],borderWidth:"thin",mt:["15px","0px"],mb:["15px","0px"],ml:["auto","0px"],mr:["auto","0px"],borderColor:r.chunks.item.chordsPattern.divider,...t})},J=t=>{const{song:r}=W(),{songSettings:o}=$();return e.jsxs(s,{width:"100%",position:"relative",display:["box","flex"],gap:"1em",alignItems:"stretch",justifyContent:"center",children:[e.jsx(q,{display:["none","block"],borderStyle:["solid"],...t}),t.items.map((r,s)=>e.jsxs(F.Fragment,{children:[e.jsx(Q,{...r,strumms:t.strumms}),e.jsx(q,{borderStyle:["dashed","solid"],display:[s<t.items.length-1?"block":"none","block"],...t})]},s)),o.display.times.value&&e.jsx(y,{label:`Repeat ${t.times} times`,borderColor:r.chunks.item.chordsPattern.divider,children:e.jsxs(I,{size:"sm",fontWeight:"bold",position:"absolute",top:"50%",right:"0",transform:"translate(0%, -50%)",zIndex:1,backgroundColor:r.chunks.item.chordsPattern.chord.times.background,color:r.chunks.item.chordsPattern.chord.times.color,children:["x",t.times]})})]})},K=t=>{const{song:r}=W();return e.jsxs(l,{direction:"row",alignItems:"center",position:"relative",children:[e.jsx(o,{size:"md",position:"sticky",left:"0",zIndex:5,borderRadius:"5px",padding:"3px 6px",width:"2ch",textAlign:"center",color:r.chunks.item.stringsPattern.stringNames,backgroundColor:"blackAlpha.600",children:t.name}),e.jsx(l,{direction:"row",position:"absolute",left:"30px",alignItems:"center",gap:"5px",ml:"5px",children:t.frets.map((t,o)=>"-"===t?e.jsx(s,{width:"1.2em",children:e.jsx(v,{borderWidth:"thin",borderColor:r.chunks.item.stringsPattern.filler})},o):"|"===t?e.jsx(s,{color:r.chunks.item.stringsPattern.filler,children:"|"},o):e.jsx(s,{width:"1.2em",children:e.jsx(m,{padding:"0.6em",size:"1em",fontWeight:"bold",borderWidth:"thin",backgroundColor:r.chunks.item.stringsPattern.fret.background,borderColor:r.chunks.item.stringsPattern.fret.border,color:r.chunks.item.stringsPattern.fret.text,children:e.jsx(x,{fontSize:"sm",children:t})},o)},o))})]})},V={E:0,A:1,D:2,G:3,B:4,e:5},ee=t=>{const{song:r}=W(),s=[[],[],[],[],[],[]];return t.items.forEach(e=>{if("string"==typeof e)return void s.forEach(t=>t.push(e));Object.entries(e).forEach(([e,t])=>{s[V[e]].push(t)});const t=Math.max(...s.map(e=>e.length));s.forEach(e=>{e.length!=t&&e.push("-")})}),e.jsxs(l,{direction:"column",gap:"0.5em",width:"100%",overflow:"scroll",children:[e.jsx(K,{name:"e",frets:s[5]}),e.jsx(K,{name:"B",frets:s[4]}),e.jsx(K,{name:"G",frets:s[3]}),e.jsx(K,{name:"D",frets:s[2]}),e.jsx(K,{name:"A",frets:s[1]}),e.jsx(K,{name:"E",frets:s[0]}),e.jsx(v,{borderColor:r.chunks.item.stringsPattern.divider})]})},te=t=>{const{song:r}=W();return e.jsx(o,{as:"h3",size:"md",textAlign:"center",textDecoration:"underline",textTransform:"capitalize",color:r.chunks.item.title,children:e.jsxs(x,{as:"span",position:"relative",fontSize:["lg","xl"],children:[t.name,t.times>1&&e.jsxs(I,{size:"sm",position:"absolute",bottom:0,right:0,transform:"translate(120%, 20%)",backgroundColor:r.chunks.item.times.background,color:r.chunks.item.times.color,children:["x",t.times]})]})})},re=t=>e.jsx(l,{direction:"column",alignItems:"center",gap:"1em",children:t.chunks.map((r,s)=>"chords"===t.type?e.jsx(J,{...r,strumms:t.strumms},s):"strings"===t.type?e.jsx(ee,{...r},s):(console.warn(`Unimplemented pattern type "${t.type}`),e.jsx(e.Fragment,{})))}),se=o=>{const{song:c}=W();return e.jsx(e.Fragment,{children:o.order.map((a,l)=>{const d=o.segments[a];return console.assert(void 0!==d,`Failed to find song segment data for "${a}"`),e.jsxs(t,{borderColor:c.chunks.divider,children:[e.jsxs(r,{display:"flex",justifyContent:"flex-end",alignItems:"center",position:"relative",pt:["10px","15px"],pb:["10px","15px"],mb:["0px","5px"],backgroundColor:"blackAlpha.100",_hover:{backgroundColor:"blackAlpha.100"},children:[e.jsx(s,{position:"absolute",left:"50%",transform:"translateX(-50%)",textAlign:"center",width:"100%",children:e.jsx(te,{...d,strumms:o.strumms})}),e.jsx(n,{color:c.chunks.item.title})]}),e.jsx(i,{children:e.jsx(re,{...d,strumms:o.strumms})})]},`${a}-${l}`)})})},oe=t=>{const{song:r}=W();return e.jsxs(A,{maxW:["100vw","5xl"],padding:["25px 0px","2em 1em"],borderRadius:["0em","0.5em"],height:"100%",overflowY:"scroll",backgroundColor:r.background,children:[e.jsx(_,{directory:t.directory,title:t.title,artists:t.artists,capo:t.capo,type:t.type,contributors:t.contributors}),e.jsxs(L,{allowMultiple:!0,padding:["1.5em 0em","1.5em 1em"],borderRadius:"1rem",defaultIndex:[0,...t.order.map((e,t)=>t+1)],backgroundColor:r.chunks.background,children:[e.jsx(U,{chordIDs:t.chordIDs}),e.jsx(se,{segments:t.segments,order:t.order,strumms:t.strumms})]}),e.jsx(H,{notes:t.notes}),e.jsx(Z,{res:t.res})]})},ne=()=>{const{directory:t}=E(),{song:r}=W(),{songsHistory:s}=$(),[o,n]=F.useState(null);return F.useLayoutEffect(()=>D(r.background),[r.background]),F.useEffect(()=>{t&&fetch(`/songs/${t}/config.min.json`).then(e=>e.ok?e.json():(console.error(`Song ${t} not found`),null)).then(e=>{e&&n({data:e,directory:t})})},[t]),F.useEffect(()=>{var e,t;o&&s.set?.((e={title:o.data.title,artists:o.data.artists,directory:o.directory},(t=s.value).length>0&&t[0].directory===e.directory?t:[e,...t]))},[o,s]),o?e.jsx(oe,{directory:o.directory,...o.data}):e.jsx("div",{children:"Loading song..."})};export{ne as SongPage,ne as default};
