import{j as e,b as r,c as t,B as s,H as o,d as n,e as i,L as c,a,F as l,Q as d,I as h,g as x,T as m,R as u,U as g,W as p,X as j,a0 as b,a1 as f,Y as k,m as y,h as C,D as v,E as w,a2 as S,Z as z,a3 as I,_ as P,A}from"./chakra-Do366R1-.js";import{C as L}from"./Chord-BIR6STOo.js";import{u as W,a as $,s as D}from"./index-D-ZjuAJi.js";import{r as E,i as F}from"./react-DbiYpRmf.js";import{a as R,b as B,G as O,I as M,c as T}from"./react-icons-DGsbL8xG.js";import"./react-virtualized-Cq2ZoWce.js";const N=l=>{const{chordsIndex:d}=W(),{song:h}=$();return e.jsxs(r,{borderColor:h.chunks.divider,children:[e.jsxs(t,{display:"flex",justifyContent:"flex-end",alignItems:"center",position:"relative",pt:["10px","15px"],pb:["10px","15px"],mb:["0px","5px"],backgroundColor:"blackAlpha.100",_hover:{backgroundColor:"blackAlpha.100"},children:[e.jsx(s,{position:"absolute",left:"50%",transform:"translateX(-50%)",textAlign:"center",width:"100%",children:e.jsx(o,{as:"h3",size:"md",textDecoration:"underline",color:h.chunks.item.title,children:"Chords"})}),e.jsx(n,{color:h.chunks.item.title})]}),e.jsx(i,{children:e.jsx(c,{display:"flex",gap:"10px",overflowX:"auto",children:l.chordIDs.map(r=>{const t=d[r];return void 0===t?(console.error(`Missing chord config for ID ${r}`),null):e.jsx(a,{children:e.jsx(L,{...t,containerProps:{fontSize:["8px","10px","12px"]}})},r)})})})]})},U={acoustic:e.jsx(B,{}),electric:e.jsx(R,{})},X=r=>{const{song:t}=$(),[n,i]=E.useState(!1);return e.jsxs(l,{direction:"column",alignItems:"center",mb:"15px",children:[e.jsxs(s,{position:"relative",width:["70px","80px"],height:["70px","80px"],mb:["5px"],children:[e.jsx(d,{isLoaded:n,width:"100%",height:"100%",borderRadius:"10px",children:e.jsx(h,{src:`/songs/${r.directory}/cover-192x192.webp`,srcSet:`\n              /songs/${r.directory}/cover-64x64.webp   64w,\n              /songs/${r.directory}/cover-128x128.webp 128w,\n              /songs/${r.directory}/cover-192x192.webp 192w`,alt:`${r.title} cover`,width:"100%",height:"100%",objectFit:"cover",borderRadius:"10px",borderStyle:"solid",borderWidth:"thin",onLoad:()=>i(!0),borderColor:t.header.coverBorder})}),e.jsx(x,{position:"absolute",right:"0",top:"0",transform:"translate(50%, -50%)",size:"1em",padding:"15px",fontWeight:"bold",borderWidth:"thin",backgroundColor:t.capo.background,borderColor:t.capo.border,color:t.capo.text,children:e.jsxs(l,{alignItems:"end",children:[e.jsx(m,{fontSize:"sm",children:"C"}),e.jsx(m,{fontSize:"xs",children:r.capo})]})})]}),e.jsx(o,{noOfLines:1,as:"h1",size:["sm","md"],mb:["5px"],textAlign:"center",color:t.header.title,children:r.title}),e.jsx(o,{noOfLines:1,as:"h2",size:["xs","sm"],mb:["5px"],fontStyle:"italic",textAlign:"center",color:t.header.artists,children:r.artists.map((t,o)=>e.jsxs(s,{as:"span",children:[t," ",o<r.artists.length-1&&", "]},o))}),e.jsxs(u,{isLazy:!0,children:[e.jsx(g,{children:e.jsx(m,{as:"button",fontSize:"sm",mb:"10px",color:t.header.artists,_hover:{textDecoration:"underline",cursor:"pointer"},children:"Contributors"})}),e.jsxs(p,{textAlign:"center",borderColor:t.header.contributors.border,children:[e.jsx(j,{backgroundColor:t.header.contributors.heading}),e.jsx(b,{color:t.header.contributors.title}),e.jsx(f,{fontWeight:"bold",borderBottom:"1px solid",backgroundColor:t.header.contributors.heading,color:t.header.contributors.title,children:"Song contributed by"}),e.jsx(k,{backgroundColor:t.header.contributors.content,color:t.header.contributors.contributor,children:r.contributors.length>0?r.contributors.map((t,s)=>e.jsx(m,{fontSize:"sm",mb:s<r.contributors.length-1?"2px":"0",children:t},s)):e.jsx(m,{fontSize:"sm",fontStyle:"italic",children:"No contributors"})})]})]}),e.jsx(l,{justifyContent:"center",color:t.header.typeTags,children:r.type.map((r,t)=>e.jsx(E.Fragment,{children:e.jsx(y,{label:r,children:U[r]})},t))})]})};function _(e){return O({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M4.7134 7.12811L4.46682 7.69379C4.28637 8.10792 3.71357 8.10792 3.53312 7.69379L3.28656 7.12811C2.84706 6.11947 2.05545 5.31641 1.06767 4.87708L0.308047 4.53922C-0.102682 4.35653 -0.102682 3.75881 0.308047 3.57612L1.0252 3.25714C2.03838 2.80651 2.84417 1.97373 3.27612 0.930828L3.52932 0.319534C3.70578 -0.106511 4.29417 -0.106511 4.47063 0.319534L4.72382 0.930828C5.15577 1.97373 5.96158 2.80651 6.9748 3.25714L7.69188 3.57612C8.10271 3.75881 8.10271 4.35653 7.69188 4.53922L6.93228 4.87708C5.94451 5.31641 5.15288 6.11947 4.7134 7.12811ZM3.06361 21.6132C4.08854 15.422 6.31105 1.99658 21 1.99658C19.5042 4.99658 18.5 6.49658 17.5 7.49658L16.5 8.49658L18 9.49658C17 12.4966 14 15.9966 10 16.4966C7.33146 16.8301 5.66421 18.6635 4.99824 21.9966H3C3.02074 21.8722 3.0419 21.7443 3.06361 21.6132Z"},child:[]}]})(e)}const G=r=>{const{song:t}=$();return e.jsx(E.Fragment,{children:r.notes.length>0&&e.jsxs(s,{mt:"1em",padding:"1em 1.25em",children:[e.jsx(o,{as:"h1",size:"md",mb:"1em",textAlign:"center",children:e.jsxs(l,{justifyContent:"center",alignItems:"center",gap:"0.25em",color:t.notes.title,children:[e.jsx(C,{as:_}),"Notes",e.jsx(C,{as:_})]})}),e.jsx(c,{textAlign:"center",color:t.notes.title,children:r.notes.map((t,s)=>e.jsxs(E.Fragment,{children:[e.jsx(m,{children:t}),s<r.notes.length-1&&e.jsx(v,{mt:"1em",mb:"1em"})]},s))})]})})},H=r=>{const{song:t}=$(),o=(e=>{try{const r=new URL(e);return"www.youtube.com"===r.hostname||"youtube.com"===r.hostname||"m.youtube.com"===r.hostname?r.pathname.startsWith("/shorts/")?r.pathname.split("/")[2]:r.searchParams.get("v"):"youtu.be"===r.hostname?r.pathname.slice(1):null}catch{return null}})(r.link),[n,i]=E.useState(!1);return e.jsx(a,{children:e.jsxs(l,{direction:"column",alignItems:"center",textAlign:"center",children:[e.jsx(C,{as:M,color:t.resources.item.note}),e.jsx(w,{isExternal:!0,href:r.link.replaceAll("{book-of-frets}","/"),size:["xs","sm"],color:t.resources.item.alias,children:r.alias}),"-"!==r.author&&e.jsxs(m,{fontStyle:"italic",textAlign:"center",fontSize:["small","sm"],color:t.resources.item.author,children:["by ",r.author]}),o&&e.jsx(s,{width:"100%",maxW:"400px",my:2,overflow:"hidden",borderRadius:"10px",children:e.jsx(S,{ratio:16/9,children:e.jsx(d,{isLoaded:n,height:"100%",width:"100%",children:e.jsx("iframe",{src:`https://www.youtube-nocookie.com/embed/${o}`,title:r.alias,allow:"accelerometer;  clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,onLoad:()=>i(!0),style:{width:"100%",height:"100%",border:"none"}})})})})]})})},Z=r=>{const{song:t}=$();return e.jsxs(s,{mt:"1em",padding:"1em 1.25em",children:[e.jsx(o,{as:"h1",size:"md",mb:"1em",textAlign:"center",children:e.jsxs(l,{justifyContent:"center",alignItems:"center",gap:"0.25em",color:t.resources.title,children:[e.jsx(C,{as:T}),"Resources",e.jsx(C,{as:T})]})}),0===r.resources.length&&e.jsx(m,{textAlign:"center",children:"Nothing here yet"}),e.jsx(c,{children:r.resources.map((s,o)=>e.jsxs(E.Fragment,{children:[e.jsx(H,{...s}),e.jsx(a,{children:o<r.resources.length-1&&e.jsx(v,{mt:"1em",mb:"1em",borderColor:t.resources.item.alias})})]},o))})]})},Y=["De","Ue"],Q=r=>{const{song:t}=$(),{chordsIndex:o,songSettings:n}=W();return e.jsxs(l,{direction:"column",alignItems:"center",justifyContent:"flex-end",children:[e.jsx(l,{direction:"column",gap:"5px",alignItems:r.align||"center",children:r.chordIDs.map((r,n)=>e.jsx(l,{direction:"row",gap:"1em",mb:"0.6em",children:r.map((r,n)=>{if("|"===r)return e.jsx(v,{height:"22px",borderWidth:"thin",borderColor:t.chunks.divider});const i=o[r];return console.assert(void 0!==i,`Missing chord index for ID '${r}'`),e.jsx(s,{as:"span",children:e.jsxs(u,{isLazy:!0,children:[e.jsx(g,{children:e.jsx(z,{as:"button",fontWeight:"bold",cursor:"pointer",backgroundColor:t.chunks.item.chordsPattern.chord.background,color:t.chunks.item.chordsPattern.chord.color,children:"-"!==r?i.name:"-"})}),e.jsx(I,{children:e.jsxs(p,{zIndex:1,backgroundColor:t.chunks.item.chordsPattern.chord.segment.popover.background,borderColor:t.chunks.item.chordsPattern.chord.segment.popover.border,children:[e.jsx(j,{backgroundColor:t.chunks.item.chordsPattern.chord.segment.popover.arrow}),e.jsx(b,{color:t.chunks.item.chordsPattern.chord.segment.popover.closeButton}),e.jsx(l,{justifyContent:"center",padding:"25px",children:e.jsx(L,{...i})})]})})]})},n)})},n))}),n.display.chordTimes.value&&e.jsx(y,{label:`Strum ${r.chordTimes} times`,children:e.jsxs(m,{fontSize:"xs",fontWeight:"bold",color:t.chunks.item.chordsPattern.chord.segment.times,children:["x",r.chordTimes]})}),n.display.strummingPattern.value&&e.jsx(s,{position:"relative",mt:"0.4em",children:e.jsx(l,{direction:"row",gap:"0.5em",alignItems:"end",color:t.chunks.item.chordsPattern.chord.segment.pattern,children:r.strummingPattern.map((r,t)=>e.jsx(m,{fontWeight:"bold",textDecoration:Y.includes(r)?"underline":"none",children:r.replace("e","")},t))})})]})},q=r=>{const{song:t}=$();return e.jsx(v,{orientation:"vertical",height:["0px","auto"],width:["70%","0px"],borderWidth:"thin",mt:["15px","0px"],mb:["15px","0px"],ml:["auto","0px"],mr:["auto","0px"],borderColor:t.chunks.item.chordsPattern.divider,...r})},J=r=>{const{song:t}=$(),{songSettings:o}=W();return e.jsxs(s,{width:"100%",position:"relative",display:["box","flex"],gap:"1em",alignItems:"stretch",justifyContent:"center",children:[e.jsx(q,{display:["none","block"],borderStyle:["solid"],...r}),r.items.map((t,s)=>e.jsxs(E.Fragment,{children:[e.jsx(Q,{...t}),e.jsx(q,{borderStyle:["dashed","solid"],display:[s<r.items.length-1?"block":"none","block"],...r})]},s)),o.display.times.value&&e.jsx(y,{label:`Repeat ${r.times} times`,borderColor:t.chunks.item.chordsPattern.divider,children:e.jsxs(z,{size:"sm",fontWeight:"bold",position:"absolute",top:"50%",right:"0",transform:"translate(0%, -50%)",zIndex:1,backgroundColor:t.chunks.item.chordsPattern.chord.times.background,color:t.chunks.item.chordsPattern.chord.times.color,children:["x",r.times]})})]})},K=r=>{const{song:t}=$();return e.jsxs(l,{direction:"row",alignItems:"center",position:"relative",children:[e.jsx(o,{size:"md",position:"sticky",left:"0",zIndex:5,borderRadius:"5px",padding:"3px 6px",width:"2ch",textAlign:"center",color:t.chunks.item.stringsPattern.stringNames,backgroundColor:"blackAlpha.600",children:r.name}),e.jsx(l,{direction:"row",position:"absolute",left:"30px",alignItems:"center",gap:"5px",ml:"5px",children:r.frets.map((r,o)=>"-"===r?e.jsx(s,{width:"1.2em",children:e.jsx(v,{borderWidth:"thin",borderColor:t.chunks.item.stringsPattern.filler})},o):"|"===r?e.jsx(s,{color:t.chunks.item.stringsPattern.filler,children:"|"},o):e.jsx(s,{width:"1.2em",children:e.jsx(x,{padding:"0.6em",size:"1em",fontWeight:"bold",borderWidth:"thin",backgroundColor:t.chunks.item.stringsPattern.fret.background,borderColor:t.chunks.item.stringsPattern.fret.border,color:t.chunks.item.stringsPattern.fret.text,children:e.jsx(m,{fontSize:"sm",children:r})},o)},o))})]})},V={E:0,A:1,D:2,G:3,B:4,e:5},ee=r=>{const{song:t}=$(),s=[[],[],[],[],[],[]];return r.items.forEach(e=>{if("string"==typeof e)return void s.forEach(r=>r.push(e));Object.entries(e).forEach(([e,r])=>{s[V[e]].push(r)});const r=Math.max(...s.map(e=>e.length));s.forEach(e=>{e.length!=r&&e.push("-")})}),e.jsxs(l,{direction:"column",gap:"0.5em",width:"100%",overflow:"scroll",children:[e.jsx(K,{name:"e",frets:s[5]}),e.jsx(K,{name:"B",frets:s[4]}),e.jsx(K,{name:"G",frets:s[3]}),e.jsx(K,{name:"D",frets:s[2]}),e.jsx(K,{name:"A",frets:s[1]}),e.jsx(K,{name:"E",frets:s[0]}),e.jsx(v,{borderColor:t.chunks.item.stringsPattern.divider})]})},re=r=>{const{song:t}=$();return e.jsx(o,{as:"h3",size:"md",textAlign:"center",textDecoration:"underline",textTransform:"capitalize",color:t.chunks.item.title,children:e.jsxs(m,{as:"span",position:"relative",fontSize:["lg","xl"],children:[r.name,r.times>1&&e.jsxs(z,{size:"sm",position:"absolute",bottom:0,right:0,transform:"translate(120%, 20%)",backgroundColor:t.chunks.item.times.background,color:t.chunks.item.times.color,children:["x",r.times]})]})})},te=r=>e.jsx(l,{direction:"column",alignItems:"center",gap:"1em",children:r.chunks.map((t,s)=>"chords"===r.type?e.jsx(J,{...t},s):"strings"===r.type?e.jsx(ee,{...t},s):(console.warn(`Unimplemented pattern type "${r.type}`),e.jsx(e.Fragment,{})))}),se=o=>{const{song:c}=$();return e.jsx(e.Fragment,{children:o.songSegmentsOrder.map((a,l)=>{const d=o.songSegments[a];return console.assert(void 0!==d,`Failed to find song segment data for "${a}"`),e.jsxs(r,{borderColor:c.chunks.divider,children:[e.jsxs(t,{display:"flex",justifyContent:"flex-end",alignItems:"center",position:"relative",pt:["10px","15px"],pb:["10px","15px"],mb:["0px","5px"],backgroundColor:"blackAlpha.100",_hover:{backgroundColor:"blackAlpha.100"},children:[e.jsx(s,{position:"absolute",left:"50%",transform:"translateX(-50%)",textAlign:"center",width:"100%",children:e.jsx(re,{...d})}),e.jsx(n,{color:c.chunks.item.title})]}),e.jsx(i,{children:e.jsx(te,{...d})})]},`${a}-${l}`)})})},oe=r=>{const{song:t}=$();return e.jsxs(P,{maxW:["100vw","5xl"],padding:["25px 0px","2em 1em"],borderRadius:["0em","0.5em"],height:"100%",overflowY:"scroll",backgroundColor:t.background,children:[e.jsx(X,{directory:r.directory,title:r.title,artists:r.artists,capo:r.capo,type:r.type,contributors:r.contributors}),e.jsxs(A,{allowMultiple:!0,padding:["1.5em 0em","1.5em 1em"],borderRadius:"1rem",defaultIndex:[0,...r.songSegmentsOrder.map((e,r)=>r+1)],backgroundColor:t.chunks.background,children:[e.jsx(N,{chordIDs:r.chordIDs}),e.jsx(se,{songSegments:r.songSegments,songSegmentsOrder:r.songSegmentsOrder})]}),e.jsx(G,{notes:r.notes}),e.jsx(Z,{resources:r.resources})]})},ne=()=>{const{directory:r}=F(),{song:t}=$(),{songsHistory:s}=W(),[o,n]=E.useState(null);return E.useLayoutEffect(()=>D(t.background),[t.background]),E.useEffect(()=>{r&&fetch(`/songs/${r}/config.json`).then(e=>e.ok?e.json():(console.error(`Song ${r} not found`),null)).then(e=>{e&&n({data:e,directory:r})})},[r]),E.useEffect(()=>{var e,r;o&&s.set?.((e={title:o.data.title,artists:o.data.artists,directory:o.directory},(r=s.value).length>0&&r[0].directory===e.directory?r:[e,...r]))},[o,s]),o?e.jsx(oe,{directory:o.directory,...o.data}):e.jsx("div",{children:"Loading song..."})};export{ne as SongPage,ne as default};
