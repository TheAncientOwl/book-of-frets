import{j as e,F as o,B as a,l as f,T as m,m as x,H as h,n as u,C as p,d as C,o as S}from"./chakra-B25fMIrp.js";import{r as c,u as w}from"./react-BTPqQck7.js";import{u as y}from"./index-DP2nvt9P.js";import{G as T,a as v}from"./react-icons-BnthliJ0.js";const I="-",z=t=>{const{chordsIndex:s}=y();return e.jsxs(o,{direction:"column",alignItems:"center",children:[e.jsx(o,{direction:"row",gap:"1em",mb:"0.6em",children:t.chordIDs.map((n,r)=>{const i=s[n];return console.assert(i!==void 0,`Missing chord index for ID '${n}'`),e.jsx(a,{as:"span",children:e.jsx(f,{backgroundColor:"green.200",fontWeight:"bold",children:n!==I?i.name:"-"})},r)})}),t.showChordTimes&&e.jsxs(m,{fontSize:"xs",fontWeight:"bold",children:["x",t.chordTimes]}),e.jsx(a,{position:"relative",mt:"0.4em",children:e.jsx(o,{direction:"row",gap:"0.5em",alignItems:"end",children:t.strummingPattern.map((n,r)=>e.jsx(m,{fontWeight:"bold",children:n},r))})})]})},j=()=>e.jsx(x,{orientation:"vertical",height:["0px","80px"],borderColor:"gray.600",borderWidth:"thin",borderStyle:["dashed","solid"],mt:["15px","0px"],mb:["15px","0px"]}),W=t=>e.jsxs(a,{width:"100%",position:"relative",display:["box","flex"],gap:"1em",alignItems:"center",justifyContent:"center",children:[e.jsx(j,{}),t.segments.map((s,n)=>e.jsxs(c.Fragment,{children:[e.jsx(z,{...s,showChordTimes:t.showChordTimes}),e.jsx(j,{})]},n)),e.jsxs(f,{size:"sm",fontWeight:"bold",backgroundColor:"green.200",position:"absolute",top:"50%",right:"0",transform:"translate(0%, -50%)",zIndex:1,children:["x",t.times]})]}),d=t=>e.jsxs(o,{direction:"row",alignItems:"center",gap:"1em",position:"relative",children:[e.jsx(h,{size:"md",children:t.name}),e.jsx(o,{direction:"row",position:"absolute",left:"30px",alignItems:"center",gap:"5px",children:t.frets.map((s,n)=>e.jsx(a,{children:s==="-"?e.jsx(a,{width:"1.4em",children:e.jsx(x,{borderColor:"black",borderWidth:"thin"})}):e.jsx(a,{width:"1.4em",children:e.jsx(u,{size:"1.4em",bg:"green.300",color:"green.900",fontWeight:"bold",borderColor:"green.900",borderWidth:"thin",children:s},n)})}))})]}),$=t=>{const s=[["-"],["-"],["-"],["-"],["-"],["-"],["-"]];return t.segments.forEach(n=>{n.forEach(i=>{const{string:l,fret:g}=i;s[l].push(g)});const r=Math.max(...s.map(i=>i.length));s.forEach(i=>{i.length!=r&&i.push("-")})}),e.jsxs(o,{direction:"column",gap:"0.5em",width:"100%",overflow:"scroll",children:[e.jsx(d,{name:"E",frets:s[6]}),e.jsx(d,{name:"B",frets:s[5]}),e.jsx(d,{name:"G",frets:s[4]}),e.jsx(d,{name:"D",frets:s[3]}),e.jsx(d,{name:"A",frets:s[2]}),e.jsx(d,{name:"E",frets:s[1]}),e.jsx(x,{borderColor:"green.900"})]})},D=t=>e.jsxs(a,{alignItems:"center",mb:"1em",children:[e.jsx(h,{as:"h3",size:"md",mb:"1em",textAlign:"center",textDecoration:"underline",textTransform:"capitalize",children:t.name}),e.jsx(o,{direction:"column",alignItems:"center",gap:"1em",children:t.patterns.map((s,n)=>t.type==="chords"?e.jsx(W,{...s,showChordTimes:t.showChordTimes},n):t.type==="strings"?e.jsx($,{...s,showChordTimes:t.showChordTimes},n):(console.warn(`Unimplemented pattern type "${t.type}`),e.jsx(e.Fragment,{})))})]}),F={acoustic:e.jsx(v,{}),electric:e.jsx(T,{})},k=t=>e.jsxs(p,{maxW:["100vw","5xl"],backgroundColor:"#237738ff",padding:["25px 10px","2em 1em"],borderRadius:"1rem",children:[e.jsxs(o,{direction:"column",alignItems:"center",mb:"15px",children:[e.jsxs(a,{position:"relative",width:["70px","80px"],height:["70px","80px"],mb:["5px"],children:[e.jsx(C,{src:`/book-of-frets/songs/${t.directory}/cover.jpeg`,alt:`${t.title} cover`,width:"100%",height:"100%",objectFit:"cover",borderRadius:"10px",borderStyle:"solid"}),e.jsx(u,{position:"absolute",right:"0",top:"0",transform:"translate(50%, -50%)",size:"1em",padding:"15px",bg:"green.300",color:"green.900",fontWeight:"bold",borderColor:"green.400",borderWidth:"thin",children:e.jsxs(o,{alignItems:"end",children:[e.jsx(m,{fontSize:"sm",children:"C"}),e.jsx(m,{fontSize:"xs",children:t.capo})]})})]}),e.jsx(h,{noOfLines:1,as:"h1",size:["sm","md"],mb:["5px"],color:"CaptionText",textAlign:"center",children:t.title}),e.jsx(h,{noOfLines:1,as:"h2",size:["xs","sm"],mb:["5px"],fontStyle:"italic",textAlign:"center",children:t.artists.map((s,n)=>e.jsxs(a,{as:"span",children:[s," ",n<t.artists.length-1&&", "]},n))}),e.jsx(o,{justifyContent:"center",children:t.type.map((s,n)=>e.jsx(c.Fragment,{children:e.jsx(S,{label:s,children:F[s]})},n))})]}),e.jsx(o,{direction:"column",gap:"5px",bgColor:"blackAlpha.400",padding:"1.5em 1em",borderRadius:"1rem",children:t.songSegmentsOrder.map((s,n)=>{const r=t.songSegments[s];return console.assert(r!==void 0,`Failed to find song segment data for "${s}"`),e.jsxs(c.Fragment,{children:[e.jsx(D,{...r,showChordTimes:Object.entries(t.songSegments).some(([i,l])=>l.type==="chords"&&l.patterns.some(g=>g.segments.some(b=>b.chordTimes>1)))}),e.jsx(x,{borderColor:"gray.600",mb:"1em"})]},`${s}-${n}`)})})]}),G=()=>{const{directory:t}=w(),[s,n]=c.useState(null);return c.useEffect(()=>{t&&fetch(`/book-of-frets/songs/${t}/config.json`).then(r=>r.ok?r.json():(console.error(`Song ${t} not found`),null)).then(r=>{r&&n(r)})},[t]),s?e.jsx(k,{directory:t||"",title:s.title,artists:s.artists,capo:s.capo,songSegments:s.songSegments,songSegmentsOrder:s.songSegmentsOrder,resources:s.resources,type:s.type}):e.jsx("div",{children:"Loading song..."})};export{G as SongPage,G as default};
