import{j as e,b as w,c as I,B as l,H as m,d as P,e as A,L as f,a as p,F as c,P as L,I as H,g as z,T as d,Q as $,R as D,U as R,W as E,$ as T,a0 as M,X as F,m as k,h as g,D as j,E as B,a1 as O,Y as C,a2 as _,Z as G,A as U}from"./chakra-9j6q7sGh.js";import{C as W}from"./Chord-Co5WIYi_.js";import{u as b,a,s as N}from"./index-ZvEg5TRw.js";import{r as h,i as Z}from"./react-CnHX3GmW.js";import{a as X,b as Y,G as Q,I as V,c as y}from"./react-icons-CUl3NLzO.js";import"./react-virtualized-BkaSW4Fc.js";const q=t=>{const{chordsIndex:r}=b(),{song:n}=a();return e.jsxs(w,{borderColor:n.chunks.divider,children:[e.jsxs(I,{display:"flex",justifyContent:"flex-end",alignItems:"center",position:"relative",pt:["10px","15px"],pb:["10px","15px"],mb:["0px","5px"],backgroundColor:"blackAlpha.100",_hover:{backgroundColor:"blackAlpha.100"},children:[e.jsx(l,{position:"absolute",left:"50%",transform:"translateX(-50%)",textAlign:"center",width:"100%",children:e.jsx(m,{as:"h3",size:"md",textDecoration:"underline",color:n.chunks.item.title,children:"Chords"})}),e.jsx(P,{color:n.chunks.item.title})]}),e.jsx(A,{children:e.jsx(f,{display:"flex",gap:"10px",overflowX:"auto",children:t.chordIDs.map(o=>{const s=r[o];return s===void 0?(console.error(`Missing chord config for ID ${o}`),null):e.jsx(p,{children:e.jsx(W,{...s,containerProps:{fontSize:["8px","10px","12px"]}})},o)})})})]})},J={acoustic:e.jsx(Y,{}),electric:e.jsx(X,{})},K=t=>{const{song:r}=a(),[n,o]=h.useState(!1);return e.jsxs(c,{direction:"column",alignItems:"center",mb:"15px",children:[e.jsxs(l,{position:"relative",width:["70px","80px"],height:["70px","80px"],mb:["5px"],children:[e.jsx(L,{isLoaded:n,width:"100%",height:"100%",borderRadius:"10px",children:e.jsx(H,{src:`/songs/${t.directory}/cover-192x192.webp`,srcSet:`
              /songs/${t.directory}/cover-64x64.webp   64w,
              /songs/${t.directory}/cover-128x128.webp 128w,
              /songs/${t.directory}/cover-192x192.webp 192w`,alt:`${t.title} cover`,width:"100%",height:"100%",objectFit:"cover",borderRadius:"10px",borderStyle:"solid",borderWidth:"thin",onLoad:()=>o(!0),borderColor:r.header.coverBorder})}),e.jsx(z,{position:"absolute",right:"0",top:"0",transform:"translate(50%, -50%)",size:"1em",padding:"15px",fontWeight:"bold",borderWidth:"thin",backgroundColor:r.capo.background,borderColor:r.capo.border,color:r.capo.text,children:e.jsxs(c,{alignItems:"end",children:[e.jsx(d,{fontSize:"sm",children:"C"}),e.jsx(d,{fontSize:"xs",children:t.capo})]})})]}),e.jsx(m,{noOfLines:1,as:"h1",size:["sm","md"],mb:["5px"],textAlign:"center",color:r.header.title,children:t.title}),e.jsx(m,{noOfLines:1,as:"h2",size:["xs","sm"],mb:["5px"],fontStyle:"italic",textAlign:"center",color:r.header.artists,children:t.artists.map((s,i)=>e.jsxs(l,{as:"span",children:[s," ",i<t.artists.length-1&&", "]},i))}),e.jsxs($,{isLazy:!0,children:[e.jsx(D,{children:e.jsx(d,{as:"button",fontSize:"sm",mb:"10px",color:r.header.artists,_hover:{textDecoration:"underline",cursor:"pointer"},children:"Contributors"})}),e.jsxs(R,{textAlign:"center",borderColor:r.header.contributors.border,children:[e.jsx(E,{backgroundColor:r.header.contributors.heading}),e.jsx(T,{color:r.header.contributors.title}),e.jsx(M,{fontWeight:"bold",borderBottom:"1px solid",backgroundColor:r.header.contributors.heading,color:r.header.contributors.title,children:"Song contributed by"}),e.jsx(F,{backgroundColor:r.header.contributors.content,color:r.header.contributors.contributor,children:t.contributors.length>0?t.contributors.map((s,i)=>e.jsx(d,{fontSize:"sm",mb:i<t.contributors.length-1?"2px":"0",children:s},i)):e.jsx(d,{fontSize:"sm",fontStyle:"italic",children:"No contributors"})})]})]}),e.jsx(c,{justifyContent:"center",color:r.header.typeTags,children:t.type.map((s,i)=>e.jsx(h.Fragment,{children:e.jsx(k,{label:s,children:J[s]})},i))})]})};function S(t){return Q({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M4.7134 7.12811L4.46682 7.69379C4.28637 8.10792 3.71357 8.10792 3.53312 7.69379L3.28656 7.12811C2.84706 6.11947 2.05545 5.31641 1.06767 4.87708L0.308047 4.53922C-0.102682 4.35653 -0.102682 3.75881 0.308047 3.57612L1.0252 3.25714C2.03838 2.80651 2.84417 1.97373 3.27612 0.930828L3.52932 0.319534C3.70578 -0.106511 4.29417 -0.106511 4.47063 0.319534L4.72382 0.930828C5.15577 1.97373 5.96158 2.80651 6.9748 3.25714L7.69188 3.57612C8.10271 3.75881 8.10271 4.35653 7.69188 4.53922L6.93228 4.87708C5.94451 5.31641 5.15288 6.11947 4.7134 7.12811ZM3.06361 21.6132C4.08854 15.422 6.31105 1.99658 21 1.99658C19.5042 4.99658 18.5 6.49658 17.5 7.49658L16.5 8.49658L18 9.49658C17 12.4966 14 15.9966 10 16.4966C7.33146 16.8301 5.66421 18.6635 4.99824 21.9966H3C3.02074 21.8722 3.0419 21.7443 3.06361 21.6132Z"},child:[]}]})(t)}const ee=t=>{const{song:r}=a();return e.jsx(h.Fragment,{children:t.notes.length>0&&e.jsxs(l,{mt:"1em",padding:"1em 1.25em",children:[e.jsx(m,{as:"h1",size:"md",mb:"1em",textAlign:"center",children:e.jsxs(c,{justifyContent:"center",alignItems:"center",gap:"0.25em",color:r.notes.title,children:[e.jsx(g,{as:S}),"Notes",e.jsx(g,{as:S})]})}),e.jsx(f,{textAlign:"center",color:r.notes.title,children:t.notes.map((n,o)=>e.jsxs(h.Fragment,{children:[e.jsx(d,{children:n}),o<t.notes.length-1&&e.jsx(j,{mt:"1em",mb:"1em"})]},o))})]})})},te=t=>{try{const r=new URL(t);return r.hostname==="www.youtube.com"||r.hostname==="youtube.com"||r.hostname==="m.youtube.com"?r.pathname.startsWith("/shorts/")?r.pathname.split("/")[2]:r.searchParams.get("v"):r.hostname==="youtu.be"?r.pathname.slice(1):null}catch{return null}},re=t=>{const{song:r}=a(),n=te(t.link),[o,s]=h.useState(!1);return e.jsx(p,{children:e.jsxs(c,{direction:"column",alignItems:"center",textAlign:"center",children:[e.jsx(g,{as:V,color:r.resources.item.note}),e.jsx(B,{isExternal:!0,href:t.link.replaceAll("{book-of-frets}","/"),size:["xs","sm"],color:r.resources.item.alias,children:t.alias}),t.author!=="-"&&e.jsxs(d,{fontStyle:"italic",textAlign:"center",fontSize:["small","sm"],color:r.resources.item.author,children:["by ",t.author]}),n&&e.jsx(l,{width:"100%",maxW:"400px",my:2,overflow:"hidden",borderRadius:"10px",children:e.jsx(O,{ratio:16/9,children:e.jsx(L,{isLoaded:o,height:"100%",width:"100%",children:e.jsx("iframe",{src:`https://www.youtube-nocookie.com/embed/${n}`,title:t.alias,allow:"accelerometer;  clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,onLoad:()=>s(!0),style:{width:"100%",height:"100%",border:"none"}})})})})]})})},ne=t=>{const{song:r}=a();return e.jsxs(l,{mt:"1em",padding:"1em 1.25em",children:[e.jsx(m,{as:"h1",size:"md",mb:"1em",textAlign:"center",children:e.jsxs(c,{justifyContent:"center",alignItems:"center",gap:"0.25em",color:r.resources.title,children:[e.jsx(g,{as:y}),"Resources",e.jsx(g,{as:y})]})}),t.resources.length===0&&e.jsx(d,{textAlign:"center",children:"Nothing here yet"}),e.jsx(f,{children:t.resources.map((n,o)=>e.jsxs(h.Fragment,{children:[e.jsx(re,{...n}),e.jsx(p,{children:o<t.resources.length-1&&e.jsx(j,{mt:"1em",mb:"1em",borderColor:r.resources.item.alias})})]},o))})]})},oe=["De","Ue"],se="e",ie="-",ce=t=>{const{song:r}=a(),{chordsIndex:n,songSettings:o}=b();return e.jsxs(c,{direction:"column",alignItems:"center",children:[e.jsx(c,{direction:"row",gap:"1em",mb:"0.6em",children:t.chordIDs.map((s,i)=>{const x=n[s];return console.assert(x!==void 0,`Missing chord index for ID '${s}'`),e.jsx(l,{as:"span",children:e.jsxs($,{isLazy:!0,children:[e.jsx(D,{children:e.jsx(C,{as:"button",fontWeight:"bold",cursor:"pointer",backgroundColor:r.chunks.item.chordsPattern.chord.background,color:r.chunks.item.chordsPattern.chord.color,children:s!==ie?x.name:"-"})}),e.jsx(_,{children:e.jsxs(R,{zIndex:1,backgroundColor:r.chunks.item.chordsPattern.chord.segment.popover.background,borderColor:r.chunks.item.chordsPattern.chord.segment.popover.border,children:[e.jsx(E,{backgroundColor:r.chunks.item.chordsPattern.chord.segment.popover.arrow}),e.jsx(T,{color:r.chunks.item.chordsPattern.chord.segment.popover.closeButton}),e.jsx(c,{justifyContent:"center",padding:"25px",children:e.jsx(W,{...x})})]})})]})},i)})}),o.display.chordTimes.value&&e.jsx(k,{label:`Strum ${t.chordTimes} times`,children:e.jsxs(d,{fontSize:"xs",fontWeight:"bold",color:r.chunks.item.chordsPattern.chord.segment.times,children:["x",t.chordTimes]})}),o.display.strummingPattern.value&&e.jsx(l,{position:"relative",mt:"0.4em",children:e.jsx(c,{direction:"row",gap:"0.5em",alignItems:"end",color:r.chunks.item.chordsPattern.chord.segment.pattern,children:t.strummingPattern.map((s,i)=>e.jsx(d,{fontWeight:"bold",textDecoration:oe.includes(s)?"underline":"none",children:s.replace(se,"")},i))})})]})},ae=(t,r)=>t&&r?"80px":t?"60px":r?"70px":"30px",v=t=>{const{song:r}=a(),{songSettings:n}=b();return e.jsx(j,{orientation:"vertical",height:["0px",ae(n.display.chordTimes.value,n.display.strummingPattern.value)],borderWidth:"thin",mt:["15px","0px"],mb:["15px","0px"],borderColor:r.chunks.item.chordsPattern.divider,...t})},le=t=>{const{song:r}=a(),{songSettings:n}=b();return e.jsxs(l,{width:"100%",position:"relative",display:["box","flex"],gap:"1em",alignItems:"center",justifyContent:"center",children:[e.jsx(v,{borderStyle:["solid"],...t}),t.items.map((o,s)=>e.jsxs(h.Fragment,{children:[e.jsx(ce,{...o}),e.jsx(v,{borderStyle:["dashed","solid"],display:[s<t.items.length-1?"block":"none","block"],...t})]},s)),n.display.times.value&&e.jsx(k,{label:`Repeat ${t.times} times`,borderColor:r.chunks.item.chordsPattern.divider,children:e.jsxs(C,{size:"sm",fontWeight:"bold",position:"absolute",top:"50%",right:"0",transform:"translate(0%, -50%)",zIndex:1,backgroundColor:r.chunks.item.chordsPattern.chord.times.background,color:r.chunks.item.chordsPattern.chord.times.color,children:["x",t.times]})})]})},u=t=>{const{song:r}=a();return e.jsxs(c,{direction:"row",alignItems:"center",position:"relative",children:[e.jsx(m,{size:"md",position:"sticky",left:"0",zIndex:5,borderRadius:"5px",padding:"3px 6px",width:"2ch",textAlign:"center",color:r.chunks.item.stringsPattern.stringNames,backgroundColor:"blackAlpha.600",children:t.name}),e.jsx(c,{direction:"row",position:"absolute",left:"30px",alignItems:"center",gap:"5px",ml:"5px",children:t.frets.map((n,o)=>n==="-"?e.jsx(l,{width:"1.2em",children:e.jsx(j,{borderWidth:"thin",borderColor:r.chunks.item.stringsPattern.filler})},o):n==="|"?e.jsx(l,{color:r.chunks.item.stringsPattern.filler,children:"|"},o):e.jsx(l,{width:"1.2em",children:e.jsx(z,{padding:"0.6em",size:"1em",fontWeight:"bold",borderWidth:"thin",backgroundColor:r.chunks.item.stringsPattern.fret.background,borderColor:r.chunks.item.stringsPattern.fret.border,color:r.chunks.item.stringsPattern.fret.text,children:e.jsx(d,{fontSize:"sm",children:n})},o)},o))})]})},de={E:0,A:1,D:2,G:3,B:4,e:5},he=t=>{const{song:r}=a(),n=[[],[],[],[],[],[]];return t.items.forEach(o=>{if(typeof o=="string"){n.forEach(i=>i.push(o));return}Object.entries(o).forEach(([i,x])=>{n[de[i]].push(x)});const s=Math.max(...n.map(i=>i.length));n.forEach(i=>{i.length!=s&&i.push("-")})}),e.jsxs(c,{direction:"column",gap:"0.5em",width:"100%",overflow:"scroll",children:[e.jsx(u,{name:"e",frets:n[5]}),e.jsx(u,{name:"B",frets:n[4]}),e.jsx(u,{name:"G",frets:n[3]}),e.jsx(u,{name:"D",frets:n[2]}),e.jsx(u,{name:"A",frets:n[1]}),e.jsx(u,{name:"E",frets:n[0]}),e.jsx(j,{borderColor:r.chunks.item.stringsPattern.divider})]})},me=t=>{const{song:r}=a();return e.jsx(m,{as:"h3",size:"md",textAlign:"center",textDecoration:"underline",textTransform:"capitalize",color:r.chunks.item.title,children:e.jsxs(d,{as:"span",position:"relative",fontSize:["lg","xl"],children:[t.name,t.times>1&&e.jsxs(C,{size:"sm",position:"absolute",bottom:0,right:0,transform:"translate(120%, 20%)",backgroundColor:r.chunks.item.times.background,color:r.chunks.item.times.color,children:["x",t.times]})]})})},ue=t=>e.jsx(c,{direction:"column",alignItems:"center",gap:"1em",children:t.chunks.map((r,n)=>t.type==="chords"?e.jsx(le,{...r},n):t.type==="strings"?e.jsx(he,{...r},n):(console.warn(`Unimplemented pattern type "${t.type}`),e.jsx(e.Fragment,{})))}),xe=t=>{const{song:r}=a();return e.jsx(e.Fragment,{children:t.songSegmentsOrder.map((n,o)=>{const s=t.songSegments[n];return console.assert(s!==void 0,`Failed to find song segment data for "${n}"`),e.jsxs(w,{borderColor:r.chunks.divider,children:[e.jsxs(I,{display:"flex",justifyContent:"flex-end",alignItems:"center",position:"relative",pt:["10px","15px"],pb:["10px","15px"],mb:["0px","5px"],backgroundColor:"blackAlpha.100",_hover:{backgroundColor:"blackAlpha.100"},children:[e.jsx(l,{position:"absolute",left:"50%",transform:"translateX(-50%)",textAlign:"center",width:"100%",children:e.jsx(me,{...s})}),e.jsx(P,{color:r.chunks.item.title})]}),e.jsx(A,{children:e.jsx(ue,{...s})})]},`${n}-${o}`)})})},ge=t=>{const{song:r}=a();return e.jsxs(G,{maxW:["100vw","5xl"],padding:["25px 0px","2em 1em"],borderRadius:["0em","0.5em"],height:"100%",overflowY:"scroll",backgroundColor:r.background,children:[e.jsx(K,{directory:t.directory,title:t.title,artists:t.artists,capo:t.capo,type:t.type,contributors:t.contributors}),e.jsxs(U,{allowMultiple:!0,padding:["1.5em 0em","1.5em 1em"],borderRadius:"1rem",defaultIndex:[0,...t.songSegmentsOrder.map((n,o)=>o+1)],backgroundColor:r.chunks.background,children:[e.jsx(q,{chordIDs:t.chordIDs}),e.jsx(xe,{songSegments:t.songSegments,songSegmentsOrder:t.songSegmentsOrder})]}),e.jsx(ee,{notes:t.notes}),e.jsx(ne,{resources:t.resources})]})};/**
 * -------------------------------------------------------------------------- *
 *                     Copyright (c) by OopsieLogsy 2025                      *
 * -------------------------------------------------------------------------- *
 * @license https://github.com/TheAncientOwl/oopsie-logsy/blob/main/LICENSE
 *
 * @file addSongHistoryEntry.ts
 * @author Alexandru Delegeanu
 * @version 0.1
 * @description Utility function to add a song entry to the history.
 */const je=(t,r)=>r.length>0&&r[0].directory===t.directory?r:[t,...r],Se=()=>{const{directory:t}=Z(),{song:r}=a(),{songsHistory:n}=b(),[o,s]=h.useState(null);return h.useLayoutEffect(()=>N(r.background),[r.background]),h.useEffect(()=>{t&&fetch(`/songs/${t}/config.json`).then(i=>i.ok?i.json():(console.error(`Song ${t} not found`),null)).then(i=>{i&&s({data:i,directory:t})})},[t]),h.useEffect(()=>{o&&n.set?.(je({title:o.data.title,artists:o.data.artists,directory:o.directory},n.value))},[o,n]),o?e.jsx(ge,{directory:o.directory,...o.data}):e.jsx("div",{children:"Loading song..."})};export{Se as SongPage,Se as default};
