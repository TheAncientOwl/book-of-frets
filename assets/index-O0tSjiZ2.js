const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Lyrics-CaMoF_48.js","assets/chakra-layout-L_gDgE6-.js","assets/react-Dawx916Q.js","assets/emotion-D3_1FDPY.js","assets/chakra-effects-BsFb7mkt.js","assets/framer-motion-CrfrA4r2.js","assets/chakra-theme-B6BH3K5N.js","assets/index-TYcMsjye.js","assets/chakra-fNkxOzZ9.js","assets/index-xTzpJM55.js","assets/index-BFjK7X7Y.js","assets/index-BTOh0T1S.js"])))=>i.map(i=>d[i]);
import{u as e,A as r,e as s,f as t,g as o,a as n,G as i,h as c,i as a,_ as l,j as d,k as h}from"./index-TYcMsjye.js";import{j as m,a8 as x,a9 as p,aa as u,ac as g,a7 as j,am as b,ah as f,aj as y}from"./chakra-layout-L_gDgE6-.js";import{C as k}from"./index-D891OSwz.js";import{r as v}from"./react-Dawx916Q.js";import{S as w,I as C,B as S,D as P,T as z}from"./chakra-fNkxOzZ9.js";import{P as I,j as T,k as L,l as _,q as D,r as $,m as A,T as F}from"./chakra-effects-BsFb7mkt.js";import{P as W}from"./chakra-theme-B6BH3K5N.js";import"./emotion-D3_1FDPY.js";import"./framer-motion-CrfrA4r2.js";const E=n=>{const{chordsIndex:i,theme:c}=e(e=>({chordsIndex:e.chordsIndex,theme:e.appTheme.song}));return m.jsxs(r,{defaultOpen:!0,children:[m.jsxs(s,{boxProps:{borderColor:c.chunks.divider,display:"flex",justifyContent:"center",alignItems:"center",position:"relative"},children:[m.jsx(x,{as:"h3",size:"md",textDecoration:"underline",width:"100%",color:c.chunks.item.title,children:"Chords"}),m.jsx(t,{boxProps:{position:"absolute",right:"10px"},color:c.chunks.item.title})]}),m.jsx(o,{children:m.jsx(p,{display:"flex",gap:"10px",overflowX:"auto",padding:["1.1em 0em","1.1em 1em"],children:n.chordIDs.map(e=>{const r=i[e];return void 0===r?(console.error(`Missing chord config for ID ${e}`),null):m.jsx(u,{children:m.jsx(k,{...r,containerProps:{fontSize:["8px","10px","11px"]}})},e)})})})]})},O={acoustic:m.jsx(c,{}),electric:m.jsx(i,{})},R=e=>{const[r,s]=v.useState(!1),t=n(e=>e.appTheme.song);return m.jsxs(g,{direction:"column",alignItems:"center",mb:"15px",children:[m.jsxs(j,{position:"relative",width:["70px","80px"],height:["70px","80px"],mb:["5px"],children:[m.jsx(w,{isLoaded:r,width:"100%",height:"100%",borderRadius:"10px",children:m.jsx(C,{src:`/songs/${e.directory}/cover-192x192.webp`,srcSet:`\n              /songs/${e.directory}/cover-64x64.webp   64w,\n              /songs/${e.directory}/cover-128x128.webp 128w,\n              /songs/${e.directory}/cover-192x192.webp 192w`,alt:`${e.title} cover`,width:"100%",height:"100%",objectFit:"cover",borderRadius:"10px",borderStyle:"solid",borderWidth:"thin",onLoad:()=>s(!0),borderColor:t.header.coverBorder})}),m.jsx(b,{position:"absolute",right:"0",top:"0",transform:"translate(50%, -50%)",size:"1em",padding:"15px",fontWeight:"bold",borderWidth:"thin",backgroundColor:t.capo.background,borderColor:t.capo.border,color:t.capo.text,children:m.jsxs(g,{alignItems:"end",children:[m.jsx(f,{fontSize:"sm",children:"C"}),m.jsx(f,{fontSize:"xs",children:e.capo})]})})]}),m.jsx(x,{noOfLines:1,as:"h1",size:["sm","md"],mb:["5px"],textAlign:"center",color:t.header.title,children:e.title}),m.jsx(x,{noOfLines:1,as:"h2",size:["xs","sm"],mb:["5px"],fontStyle:"italic",textAlign:"center",color:t.header.artists,children:e.artists.map((r,s)=>m.jsxs(v.Fragment,{children:[r," ",s<e.artists.length-1&&", "]},s))}),m.jsxs(I,{isLazy:!0,children:[m.jsx(T,{children:m.jsx(f,{as:"button",fontSize:"sm",mb:"10px",color:t.header.artists,_hover:{textDecoration:"underline",cursor:"pointer"},children:"Contributors"})}),m.jsxs(L,{overflow:"hidden",textAlign:"center",borderColor:t.header.contributors.border,children:[m.jsx(_,{backgroundColor:t.header.contributors.heading}),m.jsx(D,{color:t.header.contributors.title}),m.jsx($,{fontWeight:"bold",borderBottom:"1px solid",backgroundColor:t.header.contributors.heading,color:t.header.contributors.title,children:"Song contributed by"}),m.jsx(A,{backgroundColor:t.header.contributors.content,color:t.header.contributors.contributor,children:e.contributors.length>0?e.contributors.map((r,s)=>m.jsx(f,{fontSize:"sm",mb:s<e.contributors.length-1?"2px":"0",children:r},s)):m.jsx(f,{fontSize:"sm",fontStyle:"italic",children:"No contributors"})})]})]}),m.jsx(g,{justifyContent:"center",color:t.header.typeTags,children:e.type.map((e,r)=>m.jsx(v.Fragment,{children:m.jsx(F,{label:e,children:O[e]})},r))})]})},B=e=>m.jsx(m.Fragment,{children:e.available&&m.jsx(j,{display:"flex",justifyContent:"center",mb:"1em",children:m.jsx(S,{size:"sm",onClick:e.onClick,colorScheme:e.lyricsShown?"red":"purple",children:e.lyricsShown?"Hide Lyrics":"Show Lyrics"})})}),V=["De","Ue"],N=(e,r)=>{const s=[];for(let t=2;t<e.length;t+=2)s.push(r(e[t-1],e[t],t-1));return s},G=r=>{const{theme:s,chordsIndex:t,songSettings:o}=e(e=>({theme:e.appTheme.song,chordsIndex:e.chordsIndex,songSettings:e.songSettings}));return m.jsxs(g,{direction:"column",justifyContent:"center",alignItems:"center",gap:"0.5rem",children:[m.jsx(g,{direction:"row",gap:"20px",children:N(r.data,(e,r,n)=>{if("|"===e)return m.jsx(P,{height:"22px",borderWidth:"thin",borderColor:s.chunks.divider});const i=t[e];return void 0===i&&console.error(`Missing chord index for ID '${e}'`),m.jsx(j,{as:"span",children:m.jsxs(I,{isLazy:!0,children:[m.jsx(T,{children:m.jsxs(z,{as:"button",fontWeight:"bold",cursor:"pointer",position:"relative",backgroundColor:s.chunks.item.chordsPattern.chord.background,color:s.chunks.item.chordsPattern.chord.color,children:["-"!==e&&void 0!==i?i.name:"-",o.display.chordTimes&&("1"!==r||o.display.chordTimesOne)&&m.jsx(F,{label:`Strum ${r} times`,children:m.jsx(f,{position:"absolute",top:"-10px",right:"0",transform:"translateX(100%)",fontSize:"xs",fontWeight:"bold",color:s.chunks.item.chordsPattern.chord.segment.times,children:r})})]})}),m.jsx(W,{children:i&&m.jsxs(L,{zIndex:1,backgroundColor:s.chunks.item.chordsPattern.chord.segment.popover.background,borderColor:s.chunks.item.chordsPattern.chord.segment.popover.border,children:[m.jsx(_,{backgroundColor:s.chunks.item.chordsPattern.chord.segment.popover.arrow}),m.jsx(D,{color:s.chunks.item.chordsPattern.chord.segment.popover.closeButton}),m.jsx(g,{justifyContent:"center",padding:"25px",children:m.jsx(k,{...i})})]})})]})},n)})}),r.showPattern&&o.display.strummingPattern&&m.jsx(j,{position:"relative",mt:"0.4em",children:m.jsx(g,{direction:"row",gap:"0.5em",alignItems:"end",color:s.chunks.item.chordsPattern.chord.segment.pattern,children:r.strummingPattern.map((e,r)=>m.jsx(f,{fontWeight:"bold",textDecoration:V.includes(e)?"underline":"none",children:e.replace("e","")},r))})})]})},M=e=>{const r=n(e=>e.songSettings.display.chordTimesOne),s=e.data.map(e=>e.split(" ")),t=0===s.length||s.every(e=>e[0]===s[0][0]);return m.jsx(g,{direction:t?"column":"row",alignItems:"center",justifyContent:"center",gap:r?"1.5rem":"1rem",children:s.map((r,t)=>{const o=Number(r[0]);return o>=e.strumms.length?(console.error({message:`Found strum index ${o} when strumms length is ${e.strumms.length}`,strumms:e.strumms}),null):m.jsx(G,{data:r,strummingPattern:e.strumms[o],showPattern:t===s.length-1||o!==Number(s[t+1][0])},t)})})},X=e=>{const r=n(e=>e.appTheme.song);return m.jsx(P,{orientation:"vertical",height:["0px","auto"],width:["70%","0px"],borderWidth:"thin",mt:["15px","0px"],mb:["15px","0px"],ml:["auto","0px"],mr:["auto","0px"],borderColor:r.chunks.item.chordsPattern.divider,...e})},U=v.lazy(()=>l(()=>import("./Lyrics-CaMoF_48.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8])).then(e=>({default:e.ChordsChunkLyrics}))),q=r=>{const{theme:s,settingsDisplaySegmentTimes:t}=e(e=>({theme:e.appTheme.song,settingsDisplaySegmentTimes:e.songSettings.display.segmentTimes})),o=t&&r.times>1;return m.jsxs(v.Fragment,{children:[m.jsxs(j,{width:"100%",position:"relative",display:["box","flex"],gap:"1em",alignItems:"stretch",justifyContent:"center",fontSize:["0.85em","0.9em","1em"],maxWidth:"fit-content",border:"none",borderWidth:"thin",borderRight:[o?"1px solid red":"none","none"],paddingRight:[o?"1em":"0em","0em"],borderColor:s.chunks.item.chordsPattern.divider,children:[m.jsx(X,{display:["none","block"],borderStyle:["solid"]}),r.items.map((e,s)=>m.jsxs(v.Fragment,{children:[m.jsx(M,{data:e,strumms:r.strumms}),m.jsx(X,{borderStyle:["none","solid"],display:[s<r.items.length-(o?2:1)?"block":"none","block"]})]},s)),o&&m.jsx(F,{label:`Repeat ${r.times} times`,borderColor:s.chunks.item.chordsPattern.divider,children:m.jsxs(f,{size:"sm",fontWeight:"bold",position:"absolute",top:"50%",right:"0",transform:"translate(150%, -50%)",zIndex:1,color:s.chunks.item.chordsPattern.chord.times.color,children:["x",r.times]})})]}),m.jsx(v.Suspense,{fallback:m.jsx(a,{}),children:m.jsx(U,{visible:r.showLyrics,lyrics:r.lyrics})})]})},H=({name:e,frets:r})=>{const s=n(e=>e.appTheme.song);return m.jsxs(g,{align:"center",children:[m.jsx(j,{position:"sticky",left:"0",zIndex:5,backgroundColor:"blackAlpha.700",px:"1",fontWeight:"bold",color:s.chunks.item.stringsPattern.stringNames,fontFamily:"monospace",children:e}),m.jsx(f,{backgroundColor:"blackAlpha.200",fontFamily:"monospace",whiteSpace:"pre",color:s.chunks.item.stringsPattern.fret.text,children:r})]})},Y=({chords:e})=>{const r=n(e=>e.appTheme.song),s=e.map((r,s)=>0===s?r.name:" ".repeat(r.offset-e[s-1].offset-e[s-1].name.length)+r.name).join("");return m.jsx(f,{ml:"3ch",fontFamily:"monospace",whiteSpace:"pre",color:r.chunks.item.stringsPattern.stringNames,children:s})},J=e=>{const r=n(e=>e.appTheme.song),{stringsToFrets:s,chords:t}=(e=>{const r={E:["|"],A:["|"],D:["|"],G:["|"],B:["|"],e:["|"]},s=[],t=Object.values(r);let o=0;return e.split(" ").map(e=>{if("-"===e||"|"===e)return t.forEach(r=>r.push(e)),void(o+=1);if("["===e.charAt(0))return void s.push({name:e.slice(1,e.length-1),offset:o});let n,i=0;e.split("+").map(e=>{const s=r[e.charAt(0)],t=e.slice(1);i=Math.max(i,t.length),s.push(t),n=s.length}),void 0!==n&&(t.forEach(e=>{e.length<n&&e.push("-".repeat(i))}),o+=i)}),t.forEach(e=>e.push("|")),{stringsToFrets:r,chords:s}})(e.items);return m.jsx(g,{direction:"column",width:"100%",overflowX:"auto",fontSize:["1.2em"],children:m.jsxs(j,{minWidth:"max-content",children:[t.length>0&&m.jsx(Y,{chords:t}),m.jsx(H,{name:"e",frets:s.e}),m.jsx(H,{name:"B",frets:s.B}),m.jsx(H,{name:"G",frets:s.G}),m.jsx(H,{name:"D",frets:s.D}),m.jsx(H,{name:"A",frets:s.A}),m.jsx(H,{name:"E",frets:s.E}),m.jsx(P,{marginTop:"1em",borderColor:r.chunks.item.stringsPattern.divider})]})})},K=e=>{const r=n(e=>e.appTheme.song);return m.jsx(x,{as:"h3",size:"md",textAlign:"center",textDecoration:"underline",textTransform:"capitalize",color:r.chunks.item.title,children:m.jsxs(f,{as:"span",position:"relative",fontSize:["lg","xl"],children:[e.name,e.times>1&&m.jsxs(z,{size:"sm",position:"absolute",bottom:0,right:0,transform:"translate(120%, 20%)",backgroundColor:r.chunks.item.times.background,color:r.chunks.item.times.color,children:["x",e.times]})]})})},Q=e=>m.jsx(g,{direction:"column",alignItems:"center",gap:"1em",padding:["1.1em 0em","1.1em 1em"],overflowX:["auto","hidden"],children:e.chunks.map((r,s)=>"chords"===e.type?m.jsx(q,{...r,strumms:e.strumms,showLyrics:e.showLyrics,lyrics:e.lyrics},s):"strings"===e.type?m.jsx(J,{...r},s):(console.warn(`Unimplemented pattern type "${e.type}`),m.jsx(m.Fragment,{})))}),Z=e=>{const i=n(e=>e.appTheme.song);return m.jsx(m.Fragment,{children:e.order.map((n,c)=>{const a=e.segments[n];return console.assert(void 0!==a,`Failed to find song segment data for "${n}"`),m.jsxs(r,{defaultOpen:!0,children:[m.jsxs(s,{boxProps:{display:"flex",justifyContent:"center",alignItems:"center",position:"relative",borderColor:i.chunks.divider},children:[m.jsx(K,{...a,strumms:e.strumms,showLyrics:e.showLyrics,lyrics:e.lyrics[c]}),m.jsx(t,{boxProps:{position:"absolute",right:"10px"},color:i.chunks.item.title})]}),m.jsx(o,{children:m.jsx(Q,{...a,strumms:e.strumms,showLyrics:e.showLyrics,lyrics:e.lyrics[c]})})]},`${n}-${c}`)})})},ee=v.lazy(()=>l(()=>import("./index-xTzpJM55.js"),__vite__mapDeps([9,1,2,3,4,5,6,7,8]))),re=v.lazy(()=>l(()=>import("./index-BFjK7X7Y.js"),__vite__mapDeps([10,1,2,3,4,5,6,7,8]))),se=v.lazy(()=>l(()=>import("./index-BTOh0T1S.js"),__vite__mapDeps([11,2])).then(e=>({default:e.InView}))),te=e=>{const r=n(e=>e.appTheme.song),[s,t]=d(e.title+"-show-lyrics",!1),[o,i]=d(e.title+"-lyrics",[]);return m.jsxs(y,{maxW:["100vw","5xl"],padding:["25px 0px","2em 1em"],borderRadius:["0em","0.5em"],height:"100%",overflowY:"scroll",backgroundColor:r.background,children:[m.jsx(R,{directory:e.directory,title:e.title,artists:e.artists,capo:e.capo,type:e.type,contributors:e.contributors}),m.jsx(B,{available:e.lyrics,lyricsShown:s,onClick:()=>{t(!s),0===o.length&&h(`/songs/${e.directory}/lyrics.min.json.gz.bin`,`/songs/${e.directory}/lyrics.min.json`,`/songs/${e.directory}/lyrics.json`,e=>i(e.lyrics),e=>{console.error("Failed to fetch song lyrics:",e)})}}),m.jsxs(j,{padding:["1.5rem 10px","1.5rem 1rem"],borderRadius:"1rem",backgroundColor:r.chunks.background,children:[m.jsx(E,{chordIDs:e.chordIDs}),m.jsx(Z,{segments:e.segments,order:e.order,strumms:e.strumms,showLyrics:s&&o.length>0,lyrics:o})]}),e.notes.length>0&&m.jsx(v.Suspense,{fallback:m.jsx(a,{}),children:m.jsx(ee,{notes:e.notes})}),m.jsx(se,{triggerOnce:!0,rootMargin:"300px",children:({inView:r,ref:s})=>m.jsx(v.Suspense,{fallback:m.jsx(a,{}),children:m.jsx(j,{ref:s,children:r?m.jsx(re,{res:e.res}):null})})})]})};export{te as Song,te as default};
